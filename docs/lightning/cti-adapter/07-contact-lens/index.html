<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<link rel="search" type="application/opensearchdescription+xml" title="Amazon Connect Salesforce CTI Adapter" href="/amazon-connect-salesforce-cti/opensearch.xml"><title data-react-helmet="true">Contact Lens | Amazon Connect Salesforce CTI Adapter</title><meta data-react-helmet="true" property="og:url" content="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/lightning/cti-adapter/07-contact-lens"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Contact Lens | Amazon Connect Salesforce CTI Adapter"><meta data-react-helmet="true" name="description" content="CTI Adapter now gives you access to your post-call Contact Lens data on your Salesforce instance. To configure this feature, you must have installed and configure the AWS Serverless application."><meta data-react-helmet="true" property="og:description" content="CTI Adapter now gives you access to your post-call Contact Lens data on your Salesforce instance. To configure this feature, you must have installed and configure the AWS Serverless application."><link data-react-helmet="true" rel="shortcut icon" href="/amazon-connect-salesforce-cti/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/lightning/cti-adapter/07-contact-lens"><link data-react-helmet="true" rel="alternate" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/lightning/cti-adapter/07-contact-lens" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/lightning/cti-adapter/07-contact-lens" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/amazon-connect-salesforce-cti/assets/css/styles.72280d89.css">
<link rel="preload" href="/amazon-connect-salesforce-cti/assets/js/runtime~main.75e2847e.js" as="script">
<link rel="preload" href="/amazon-connect-salesforce-cti/assets/js/main.468d250c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/amazon-connect-salesforce-cti/"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="v5.18" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="v5.18" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">v5.18</b></a><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/lightning/notices">Lightning</a><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/classic/notices">Classic</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/other/earlier-versions">Earlier Versions</a><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/tree/main/pdf" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>PDF<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/amazon-connect-salesforce-cti/"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="v5.18" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="v5.18" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">v5.18</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/lightning/notices">Lightning</a></li><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/classic/notices">Classic</a></li><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/other/earlier-versions">Earlier Versions</a></li><li class="menu__list-item"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/tree/main/pdf" target="_blank" rel="noopener noreferrer" class="menu__link"><span>PDF<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/lightning/notices">Notices</a></li><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/lightning/release-notes">Release Notes</a></li><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/lightning/introduction/01-key-benefits">Key Benefits and Requirements</a></li><li class="menu__list-item"><a class="menu__link menuLinkText_2aKo">Installation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/01-installation">Installing the CTI Adapter and Salesforce Lambdas</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/02-guided-setup">Setting Up The CTI Adapter Using Guided Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/03-managed-package-manual-setup">Setting Up The CTI Adapter Managed Package Manually</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/04-salesforce-lambdas-manual-setup">Setting Up The Salesforce Lambdas Manually</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/05-upgrading-from-an-earlier-version">Upgrading from an Earlier Version</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/06-adapter-installation-troubleshooting">CTI Adapter Installation Troubleshooting and Common Issues</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2aKo">CTI Adapter</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/01-cti-adapter-configuration">CTI Adapter Details</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/02-cti-attributes">CTI Attributes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/03-cti-flows">CTI Flow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/04-presence-sync-rules">Presence Sync Rules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/05-localization">Localization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/06-set-agent-status-on-session-end">Set Agent Status on Session End</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/07-contact-lens">Contact Lens</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/08-cti-actions">CTI Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/09-recording-controls">Recording Controls</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/10-voicemail-drops">Voicemail Drops</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/11-chat-widget-integration">Chat Widget Integration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/12-wisdom-integration">Wisdom Integration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/13-voice-id">Voice Id</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2aKo">Salesforce Lambdas</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/01-contact-flow-salesforce-lambdas">Accessing the Salesforce API from Amazon Connect Contact Flows Using AWS Lambda</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/02-historical-metrics">Amazon Connect Historical Metrics in Salesforce</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/03-real-time-metrics">Amazon Connect Real-Time Metrics in Salesforce</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/04-contact-channel-analytics">Contact Channel Analytics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/05-contact-trace-record-import">Contact Trace Record Import</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/06-postcall-contact-lens-import">Postcall Contact Lens Import</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2aKo">Appendices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menuLinkText_2aKo" tabindex="0">Appendix A: Required Salesforce Configurations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-a-required-salesforce-configurations/01-configuring-my-domain">Configuring My Domain in Salesforce</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-a-required-salesforce-configurations/02-configure-salesforce-omnichannel">Configure Salesforce Omnichannel for Testing</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-b-configuring-salesforce-as-your-identity-provider/01-configuration">Appendix B: Configuring Salesforce as Your Identity Provider</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-c-cti-flow-sources-and-events/01-cti-flow-sources-and-events">Appendix C: CTI Flow Sources and Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-d-cti-flow-examples/01-cti-flow-examples">Appendix D: CTI Flow Examples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-e-salesforce-high-velocity-sales/01-high-velocity-sales">Appendix E: Integration with Salesforce High Velocity Sales</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-f-cti-flow-blocks/01-cti-flow-blocks">Appendix F: CTI Flow Blocks</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">Contact Lens</h1></header><p>CTI Adapter now gives you access to your post-call Contact Lens data on your Salesforce instance. To configure this feature, you must have installed and configure the AWS Serverless application.</p><p>Three or four minutes after the call, a new Contact Channel Analytics record is created with the recording url with only the call recording. In another three minutes, this record is updated with Contact Lens recording, transcript and other metadata.</p><img src="/amazon-connect-salesforce-cti/img/lightning/cca-contact-lens-01.png"><p>The new record is also associated automatically with a Case and Contact through their Amazon Connect contact id. This means that you will be able to configure your case record page with a related list that lists all the calls related to a case.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="prerequisites"></a>Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h3><p>In order to set up Contact Lens you must first follow the steps detailed in the below sections:</p><ol><li><p><a href="/amazon-connect-salesforce-cti/docs/lightning/installation/01-installation#setting-up-the-executeawsservice-named-credential">Set up ExecuteAwsService Named Credential</a></p></li><li><p><a href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/04-contact-channel-analytics">Set up Contact Channel Analytics</a></p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configuring-related-transcripts-list-for-case-object"></a>Configuring Related Transcripts List for Case Object<a class="hash-link" href="#configuring-related-transcripts-list-for-case-object" title="Direct link to heading">#</a></h3><ol><li><p>Go to the &quot;Setup&quot; section.</p></li><li><p>Search for &quot;Object Manager&quot; in Quick Find.</p></li><li><p>Go into &quot;AC Contact Channel Analytics&quot; object.</p></li><li><p>Click on &quot;Fields &amp; Relationships&quot;</p></li><li><p>Select the &quot;Case&quot; field.</p></li><li><p>Click on &quot;Set Field-Level Security&quot; button.</p></li><li><p>In the &quot;Field-Level Security for Profile&quot; panel, select &quot;Visible&quot; for all the profiles where this field should appear.</p></li><li><p>Click &quot;Save&quot;</p></li><li><p>Click &quot;View Field Accessibility&quot; button.</p></li><li><p>Select &quot;Case&quot; field from &quot;Field accessibility for Field&quot; dropdown.</p></li><li><p>Select the profile for which you want to enable this field.</p></li><li><p>Mark &quot;Field-Level Security&quot; of the field as &quot;Visible&quot; and save.</p></li><li><p>Go to a Case record page.</p></li><li><p>Click on &quot;Edit Page&quot; under the gear button on upper right corner of the page.</p></li><li><p>Select &quot;Related List - Single&quot; from left sidebar, and drop it into &quot;Related&quot; section.</p></li><li><p>Click on the item you just droppped to focus on it.</p></li><li><p>In the right sidebar, select &quot;Case Layout (previewed)&quot;</p></li><li><p>Click on &quot;Related Lists&quot; and find &quot;Transcripts&quot; field in the panel.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/lightning/cca-related-list-05.png"><ol start="19"><li><p>Drag &quot;Transcripts&quot; into the &quot;Related Lists&quot; section on the body of the page.</p></li><li><p>Click &quot;Save&quot; and return to the page editor.</p></li><li><p>Focus on the item you droppped in step 15 again.</p></li><li><p>In the right sidebar, under the &quot;Related List&quot; dropdown, find and select &quot;Transcripts&quot; field.</p></li><li><p>Click &quot;Save&quot; to save the page layout.</p></li><li><p>Click &quot;Activation...&quot;</p></li><li><p>Go into &quot;App Default.&quot; Click on &quot;Assign as App Default.&quot;</p></li></ol><img src="/amazon-connect-salesforce-cti/img/lightning/cca-related-list-10.png"><ol start="26"><li>Select the apps you&#x27;d like the related list to appear. Click &quot;Next&quot; twice, and then finally click &quot;Save.&quot;</li></ol><p>Now your related transcripts should appear on the Case record page.</p><p>Whenever you update the Amazon Connect contact id of this case, the related list will be updated to associate the transcripts associated with your contact.</p><p>Follow the same steps above for Contact.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setting-up-the-audio-recording-streaming"></a>Setting up the Audio Recording Streaming<a class="hash-link" href="#setting-up-the-audio-recording-streaming" title="Direct link to heading">#</a></h3><p>In order to stream Audio in Contact Lens, you must first set up the Audio Recording Streaming feature. It is recommended to use the Guided Setup feature to set up audio recording streaming. </p><img src="/amazon-connect-salesforce-cti/img/shared/contactlensaudio0.png"><p>If you do not wish to use the Guided Setup feature, then see below steps for manual setup steps:</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="aws-side-setup"></a>AWS Side Setup<a class="hash-link" href="#aws-side-setup" title="Direct link to heading">#</a></h4><ol><li><p>See <a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-trusted-signers.html" target="_blank" rel="noopener noreferrer">these steps</a>. Follow the sections <em>Creating key pairs for your signers</em>, and <em>Adding a signer to a distribution</em>.
Make sure to record the <strong>public key ID</strong>.</p></li><li><p>Copy and paste the contents of the private key .pem file into a text editor. Replace every newline character with a space, and then delete the last character. This is most easily done using a &quot;find and replace&quot; feature in your text editor.
The resulting string of text should resemble the following:</p></li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">-----BEGIN RSA PRIVATE KEY----- (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (under 64 character string) -----END RSA PRIVATE KEY-----</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="3"><li><p>Navigate to the &quot;Secrets Manager&quot; service. Select the <strong>SalesforceCredentials</strong>.</p></li><li><p>Under the &quot;Secret value&quot; tab, select &quot;Retrieve secret value&quot; and then &quot;Edit&quot;.</p></li><li><p>For the <strong>CloudFrontPrivateKey</strong> field, copy and paste the modified contents of the private key .pem file. For the <strong>CloudFrontAccessKeyID</strong> field, copy and paste the <strong>Access Key Id</strong> you recorded above. Your Secrets Manager Secret should look like the following:</p></li></ol><img src="/amazon-connect-salesforce-cti/img/lightning/image270.png"><p>Please note that your secret may also be formatted stored as a &quot;Secret key/value&quot; secret rather than a &quot;Plaintext&quot; secret; both secret types are valid.</p><ol start="6"><li>Navigate to your Salesforce instance. Navigate to setup, then search for &quot;Visualforce pages.&quot;</li></ol><img src="/amazon-connect-salesforce-cti/img/lightning/image283.png"><ol start="7"><li><p>Select the <strong>AC_RecordingViewer</strong> visualforce page, and select &quot;preview.&quot; Copy the url of the opened page up until <code>.com</code>. Make sure not to include any characters after <code>.com</code>.</p></li><li><p>Navigate back to aws, to the s3 bucket where your audio recording files are stored. This s3 bucket should be the same bucket as the <strong>ConnectRecordingS3BucketName</strong> parameter to the serverless application.</p></li><li><p>In the bucket details, select the <strong>Permissions</strong> tab and then the <strong>CORS configuration</strong> tab and paste the following. Replace the AllowedOrigin with the url copied in step 9. Additionally, add in the <code>...lightning.force.com</code> url to your instance to the configuration.</p></li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;AllowedHeaders&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;AllowedMethods&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;GET&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;AllowedOrigins&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;{url copied in step 9}&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://{instanceName}.lightning.force.com/&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;ExposeHeaders&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><img src="/amazon-connect-salesforce-cti/img/lightning/image271.png"><ol start="10"><li><p>Select Save</p></li><li><p>Navigate to the &quot;Lambda&quot; aws service. Search for term &quot;sfgenerate&quot; and copy down the full name of the sfGenerateAudioRecordingStreaming lambda. This will be used in the next section.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/lightning/image274.png"><ol start="12"><li>Navigate back to the &quot;Lambda&quot; aws service main page and navigate to the <strong>us-east-1 region</strong>. Select <strong>create function</strong>.</li></ol><img src="/amazon-connect-salesforce-cti/img/lightning/audiostreaming0.png"><ol start="13"><li><p>Enter a function name, like <strong>sfSig4RequestToS3</strong>.</p></li><li><p>Select <strong>change default execution role</strong>, and <strong>use an existing role</strong>. Search for and select <em>sfSig4RequestToS3Role</em>.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/lightning/audiostreaming1.png"><ol start="15"><li><p>Select <strong>create function</strong>. On the next screen, copy and paste the contents from <a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/blob/main/docs/lightning/04-salesforce-lambdas/sfSig4RequestToS3.js" target="_blank" rel="noopener noreferrer">this file</a> into the function body, and then select <strong>Deploy</strong>.</p></li><li><p>Select the actions dropdown, and then select <strong>Deploy to Lambda@Edge</strong>.</p></li><li><p>Select the Cloudfront Distribution that was created by the Salesfore Lambdas serverless application, then check off the &quot;I acknowledge...&quot; check box, then select deploy.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/lightning/audiostreaming2.png"><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="post-call-contat-lens-data-import"></a>Post Call Contat Lens Data Import<a class="hash-link" href="#post-call-contat-lens-data-import" title="Direct link to heading">#</a></h4><p>If you want to import Contact Lens data, please follow the steps for <a href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/docs/lightning/salesforce-lambdas/06-postcall-contact-lens-import">Post Call Contact Lens Import</a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="common-audio-streaming-setup-issues"></a>Common Audio Streaming Setup Issues<a class="hash-link" href="#common-audio-streaming-setup-issues" title="Direct link to heading">#</a></h4><ol><li><p>Verify that the Secrets Manager secret contains both the <code>CloudFrontPrivateKey</code> and <code>CloudFrontAccessKeyID</code> items.</p></li><li><p>Verify that your Cloudfront distribution&#x27;s behavior is set to use <code>Trusted Key Groups</code>, and that the correct Key Group is selected.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/shared/audiostreamingkeygroups.png"><ol start="3"><li>Verify that your Cloudfront distribution&#x27;s behavior contains the sfSig4RequestToS3 edge lambda</li></ol><img src="/amazon-connect-salesforce-cti/img/shared/audiostreamingedgelambda.png"><ol start="4"><li>Verify that your S3 bucket CORS configuration is correct</li></ol><img src="/amazon-connect-salesforce-cti/img/shared/audiostreamingcorsconfiguration.png"><ol start="5"><li><p>Verify that your named credentials are correctly set up</p></li><li><p>Verify that your user is added to the AC_CallRecording permission set</p></li></ol></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/docs/lightning/03-cti-adapter/07-contact-lens.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/06-set-agent-status-on-session-end"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Set Agent Status on Session End</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/08-cti-actions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">CTI Actions Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link">Prerequisites</a></li><li><a href="#configuring-related-transcripts-list-for-case-object" class="table-of-contents__link">Configuring Related Transcripts List for Case Object</a></li><li><a href="#setting-up-the-audio-recording-streaming" class="table-of-contents__link">Setting up the Audio Recording Streaming</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
<script src="/amazon-connect-salesforce-cti/assets/js/runtime~main.75e2847e.js"></script>
<script src="/amazon-connect-salesforce-cti/assets/js/main.468d250c.js"></script>
</body>
</html>