<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Amazon Connect Salesforce CTI Adapter Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Amazon Connect Salesforce CTI Adapter Blog Atom Feed"><title data-react-helmet="true">Contact Channel Analytics | Amazon Connect Salesforce CTI Adapter</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Contact Channel Analytics | Amazon Connect Salesforce CTI Adapter"><meta data-react-helmet="true" name="description" content="In addition to the CTI adapter&#x27;s native ability to provide direct"><meta data-react-helmet="true" property="og:description" content="In addition to the CTI adapter&#x27;s native ability to provide direct"><meta data-react-helmet="true" property="og:url" content="https://amazon-connect.github.io/amazon-connect-salesforce-cti//docs/lightning/04-salesforce-lambdas/04-contact-channel-analytics"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//docs/lightning/04-salesforce-lambdas/04-contact-channel-analytics"><link rel="stylesheet" href="/styles.58bbe32c.css">
<link rel="preload" href="/styles.63fe7873.js" as="script">
<link rel="preload" href="/runtime~main.eec41197.js" as="script">
<link rel="preload" href="/main.55cc4497.js" as="script">
<link rel="preload" href="/1.6559db8c.js" as="script">
<link rel="preload" href="/2.e8dda1c7.js" as="script">
<link rel="preload" href="/64.cd1f80ee.js" as="script">
<link rel="preload" href="/65.b29e5dff.js" as="script">
<link rel="preload" href="/935f2afb.6eac2d43.js" as="script">
<link rel="preload" href="/17896441.b0393081.js" as="script">
<link rel="preload" href="/49155d7d.9beab761.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Amazon Connect Salesforce CTI Adapter" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="Amazon Connect Salesforce CTI Adapter" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Amazon Connect Salesforce CTI Adapter</strong></a><a class="navbar__item navbar__link" href="/docs/lightning/notices">Lightning</a><a class="navbar__item navbar__link" href="/docs/classic/notices">Classic</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Amazon Connect Salesforce CTI Adapter" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="Amazon Connect Salesforce CTI Adapter" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Amazon Connect Salesforce CTI Adapter</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/lightning/notices">Lightning</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/classic/notices">Classic</a></li><li class="menu__list-item"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/lightning/notices">Notices</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/lightning/release-notes">Release Notes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/lightning/01-introduction/01-key-benefits">Key Benefits and Requirements</a></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Installation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/02-installation/01-installing-package-from-appexchange">Installing CTI Adapter Managed Package from AppExchange</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/02-installation/02-installing-salesforce-lambdas">Installing the Amazon Connect Salesforce Lambda Package</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/02-installation/03-upgrading-from-an-earlier-version">Upgrading from an Earlier Version</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/02-installation/04-adapter-installation-troubleshooting">CTI Adapter Installation Troubleshooting and Common Issues</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">CTI Adapter</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/03-cti-adapter/01-cti-adapter-configuration">CTI Adapter Details</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/03-cti-adapter/02-cti-attributes">CTI Attributes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/03-cti-adapter/03-cti-flows">CTI Flow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/03-cti-adapter/04-presence-sync-rules">Presence Sync Rules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/03-cti-adapter/05-localization">Localization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/03-cti-adapter/06-set-agent-status-on-session-end">Set Agent Status on Session End</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/03-cti-adapter/07-contact-lens">Contact Lens</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/03-cti-adapter/08-cti-actions">CTI Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/03-cti-adapter/09-recording-controls">Recording Controls</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/03-cti-adapter/10-voicemail-drops">Voicemail Drops</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Salesforce Lambdas</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/04-salesforce-lambdas/01-contact-flow-salesforce-lambdas">Accessing the Salesforce API from Amazon Connect Contact Flows Using AWS Lambda</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/04-salesforce-lambdas/02-historical-metrics">Amazon Connect Historical Metrics in Salesforce</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/04-salesforce-lambdas/03-real-time-metrics">Amazon Connect Real-Time Metrics in Salesforce</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/lightning/04-salesforce-lambdas/04-contact-channel-analytics">Contact Channel Analytics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/04-salesforce-lambdas/05-contact-trace-record-import">Contact Trace Record Import</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/04-salesforce-lambdas/06-postcall-contact-lens-import">Postcall Contact Lens Import</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Appendices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-" tabindex="0">Appendix A: Required Salesforce Configurations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/05-appendices/appendix-a-required-salesforce-configurations/01-configuring-my-domain">Configuring My Domain in Salesforce</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/05-appendices/appendix-a-required-salesforce-configurations/02-configure-salesforce-omnichannel">Configure Salesforce Omnichannel for Testing</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/05-appendices/appendix-b-configuring-salesforce-as-your-identity-provider/01-configuration">Appendix B: Configuring Salesforce as Your Identity Provider</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/05-appendices/appendix-c-cti-flow-sources-and-events/01-cti-flow-sources-and-events">Appendix C: CTI Flow Sources and Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/05-appendices/appendix-d-cti-flow-examples/01-cti-flow-examples">Appendix D: CTI Flow Examples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/05-appendices/appendix-e-salesforce-high-velocity-sales/01-high-velocity-sales">Appendix E: Integration with Salesforce High Velocity Sales</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lightning/05-appendices/appendix-f-cti-flow-blocks/01-cti-flow-blocks">Appendix F: CTI Flow Blocks</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Contact Channel Analytics</h1></header><div class="markdown"><p>In addition to the CTI adapter&#x27;s native ability to provide direct
playback links to call recordings in Amazon Connect, the AWS Serverless
Application Repository for Salesforce includes several functions that
allow you to process recordings, perform quality analytics functions,
and bring data into Salesforce.</p><p>This processing is done post-call, using the Contact Trace Record (CTR)
as the initiation path. The following quality analytics options are
available:</p><ul><li><p><strong>Call Recording Streaming:</strong> streams the actual audio file into
Salesforce. This option is not mandatory for the others to function.</p></li><li><p><strong>Recording Transcript:</strong> you can choose to have your call
recordings transcribed to text and presented in a visual format that
resembles a chat conversation. This allows for quick scanning of a
call to identify key segments of conversation. This option is
required if you wish to include the next level of analysis</p></li><li><p><strong>AI-Driven Contact Analysis:</strong> once the recordings have been
transcribed to text, you can also indicate that you wish to do
further analysis of the conversation using <a href="https://aws.amazon.com/comprehend/" target="_blank" rel="noopener noreferrer">Amazon
Comprehend</a>. Available options
are:</p><ul><li><p><strong>Sentiment Analysis:</strong> returns the overall sentiment of the
conversation (Positive, Negative, Neutral, or Mixed).</p></li><li><p><strong>Keyphrase Extraction:</strong> returns the key phrases or talking
points and a confidence score to support that this is a key
phrase.</p></li><li><p><strong>Language Detection:</strong> returns the dominant language with a
confidence score to support that a language is dominant</p></li><li><p><strong>Custom Entities:</strong> allows you to customize the AI to identify
terms that are specific to your domain</p></li><li><p><strong>Syntax Analysis:</strong> analyze the transcript using tokenization
and Parts of Speech (PoS), and identify word boundaries and
labels like nouns and adjectives within the text.</p></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="call-recording-streaming"></a>Call Recording Streaming<a class="hash-link" href="#call-recording-streaming" title="Direct link to heading">#</a></h3><p>You can stream Call Recordings in your Salesforce Org. This
allows for easy access to the recordings from within Salesforce and can
be used in conjunction with the other contact channel analytics features
to provide a complete view of the customer interaction.</p><p>The import of call recordings is not required to activate the other
contact channel analytics features.</p><p>Once enabled during the AWS Serverless Application Repository for
Salesforce, recording import is activated on a call by call basis by
adding a specific contact attribute. This attribute is used during
Contact Trace Record processing to trigger the call import.</p><p>NOTE: After Call Work time is a part of the Contact Trace Record. As
such, CTRs are not generated until the agent leaves the after call work
state. If you are not seeing a recording import, please make sure the
agent has completed the call and left the after call work state.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="prerequisite-setup"></a>Prerequisite Setup<a class="hash-link" href="#prerequisite-setup" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cloudformation-template"></a>Cloudformation Template<a class="hash-link" href="#cloudformation-template" title="Direct link to heading">#</a></h5><p>To make sure that the AWS resources are set up, make sure that the
<em>PostcallRecordingImportEnabled</em> parameter is set to true in your
Cloudformation stack:</p><img src="/img/lightning/image266.png"><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="aws-side-setup"></a>AWS Side Setup<a class="hash-link" href="#aws-side-setup" title="Direct link to heading">#</a></h5><ol><li><p>See <a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-trusted-signers.html" target="_blank" rel="noopener noreferrer">these steps</a>. Follow the sections <em>Creating key pairs for your signers</em>, and <em>Adding a signer to a distribution</em>.
Make sure to record the <strong>public key ID</strong>.</p></li><li><p>Copy and paste the contents of the private key .pem file into a text editor. Replace every newline character with a space, and then delete the last character. This is most easily done using a &quot;find and replace&quot; feature in your text editor.
The resulting string of text should resemble the following:</p></li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">-----BEGIN RSA PRIVATE KEY----- (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (under 64 character string) -----END RSA PRIVATE KEY-----</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol start="3"><li><p>Navigate to the &quot;Secrets Manager&quot; service. Select the <strong>SalesforceCredentials</strong>.</p></li><li><p>Under the &quot;Secret value&quot; tab, select &quot;Retrieve secret value&quot; and then &quot;Edit&quot;.</p></li><li><p>For the <strong>CloudFrontPrivateKey</strong> field, copy and paste the modified contents of the private key .pem file. For the <strong>CloudFrontAccessKeyID</strong> field, copy and paste the <strong>Access Key Id</strong> you recorded above. Your Secrets Manager Secret should look like the following:</p></li></ol><img src="/img/lightning/image270.png"><p>Please note that your secret may also be formatted stored as a &quot;Secret key/value&quot; secret rather than a &quot;Plaintext&quot; secret; both secret types are valid.</p><ol start="6"><li>Navigate to your Salesforce instance. Navigate to setup, then search for &quot;Visualforce pages.&quot;</li></ol><img src="/img/lightning/image283.png"><ol start="7"><li><p>Select the <strong>AC_RecordingViewer</strong> visualforce page, and select &quot;preview.&quot; Copy the url of the opened page up until <code>.com</code>. Make sure not to include any characters after <code>.com</code>.</p></li><li><p>Navigate back to aws, to the s3 bucket where your audio recording files are stored. This s3 bucket should be the same bucket as the <strong>ConnectRecordingS3BucketName</strong> parameter to the serverless application.</p></li><li><p>In the bucket details, select the <strong>Permissions</strong> tab and then the <strong>CORS configuration</strong> tab and paste the following. Replace the AllowedOrigin with the url copied in step 9.</p></li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;AllowedHeaders&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;AllowedMethods&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;GET&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;AllowedOrigins&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;{url copied in step 9}&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;ExposeHeaders&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><img src="/img/lightning/image271.png"><ol start="10"><li><p>Select Save</p></li><li><p>Navigate to the &quot;IAM&quot; aws service. Select <strong>Add User</strong>.</p></li></ol><img src="/img/lightning/image272.png"><ol start="12"><li>Give your IAM user a name, like <strong>sfInvokeGenerateAudioRecordingStreamingURLIAMUser</strong>. For the &quot;AWS Access Type&quot;, select <strong>Programmatic access</strong>.</li></ol><img src="/img/lightning/image273.png"><ol start="13"><li><p>Select Next, then select &quot;Attach existing policies directly.&quot; Search for <strong>invokeSfGenerateAudioRecordingStreamingURLPolicy</strong> and select it.</p></li><li><p>Create the user, then copy down the <strong>Access key ID</strong> and the <strong>Secret access key</strong>. These keys will be used in the next section.</p></li></ol><img src="/img/lightning/image284.png"><ol start="15"><li>Navigate to the &quot;Lambda&quot; aws service. Search for term &quot;sfgenerate&quot; and copy down the full name of the sfGenerateAudioRecordingStreaming lambda. This will be used in the next section.</li></ol><img src="/img/lightning/image274.png"><ol start="16"><li>Navigate back to the &quot;Lambda&quot; aws service main page and navigate to the <strong>us-east-1 region</strong>. Select <strong>create function</strong>.</li></ol><img src="/img/lightning/audiostreaming0.png"><ol start="17"><li><p>Enter a function name, like <strong>sfSig4RequestToS3</strong>.</p></li><li><p>Select <strong>change default execution role</strong>, and <strong>use an existing role</strong>. Search for and select <em>sfSig4RequestToS3Role</em>.</p></li></ol><img src="/img/lightning/audiostreaming1.png"><ol start="19"><li><p>Select <strong>create function</strong>. On the next screen, copy and paste the contents from <a href="/docs/lightning/04-salesforce-lambdas/sfSig4RequestToS3.js">this file</a> into the function body, and then select <strong>Deploy</strong>.</p></li><li><p>Select the actions dropdown, and then select <strong>Deploy to Lambda@Edge</strong>.</p></li><li><p>Select the Cloudfront Distribution that was created by the Salesfore Lambdas serverless application, then check off the &quot;I acknowledge...&quot; check box, then select deploy.</p></li></ol><img src="/img/lightning/audiostreaming2.png"><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="salesforce-side-setup"></a>Salesforce Side Setup<a class="hash-link" href="#salesforce-side-setup" title="Direct link to heading">#</a></h5><ol><li><p>In Salesforce Setup, search for &quot;Named Credentials.&quot; Select <strong>New Named Credential.</strong></p></li><li><p>For the <strong>Name</strong> and <strong>Label</strong>, enter AwsGenerateAudioRecordingURL.</p></li><li><p>In the <strong>URL</strong> section, enter <code>https://lambda.{awsRegion}.amazonaws.com/2015-03-31/functions/{lambdaFunctionName}/invocations/</code>-- replace {awsRegion} with the awsRegion your serverless application resides in (for example, us-east-1), and replace {lambdaFunctionName} with the full name of the sfGenerateAudioRecordingStreaming lambda you recorded in the previous section.</p></li><li><p>For <strong>Identity Type</strong> select <strong>Named Principal</strong>. For the <strong>Authentication Protocol</strong>, select <strong>AWS Signature Version 4</strong>. Fill in the <strong>Access key ID</strong> you recorded in the previous section as &quot;AWS Access Key ID&quot;, the <strong>Secret access key</strong> as the &quot;AWS Secret Access Key&quot;, the AWS Region, and &quot;lambda&quot; as the &quot;AWS Service.&quot;</p></li></ol><img src="/img/lightning/image275.png"><ol start="5"><li><p>Select <strong>save</strong>.</p></li><li><p>In the setup search box, search for &quot;Permission sets&quot;. Select the &quot;AC_CallRecording&quot; permission set. Select &quot;Manage Assignments&quot;.</p></li></ol><img src="/img/lightning/image278.png"><ol start="7"><li>Select &quot;Add Assignments&quot;. Add the users that should have access to the audio recordings and select &quot;assign&quot;.</li></ol><img src="/img/lightning/image279.png"><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="enabling-call-recording-streaming"></a>Enabling call recording streaming<a class="hash-link" href="#enabling-call-recording-streaming" title="Direct link to heading">#</a></h4><ol><li><p>Login to your Amazon Connect instance as an Administrator</p></li><li><p>From the left navigation, choose <strong>Routing</strong> then select <strong>Contact
flows</strong></p></li></ol><img src="/img/lightning/image201.png"><ol start="3"><li><p>Open the contact flow that you want to use to enable call recording
import. This contact flow must have Amazon Connect&#x27;s native
recording turned on.</p></li><li><p>In you contact flow, before you transfer to queue, add a new <strong>Set
contact attributes</strong> block</p></li><li><p>Configure the block to set a contact attribute as follows:</p><p>a. <strong>Destination key:</strong> postcallRecordingImportEnabled</p><p>b. <strong>Value:</strong> true</p></li></ol><img src="/img/lightning/image202.png"><ol start="6"><li><p><strong>Save</strong> the Set contact attributes block. Make sure it is
appropriately connected to your contact flow, and <strong>Publish</strong> the
flow.</p></li><li><p>Wait approximately 2 minutes to give the contact flow time to
publish.</p></li><li><p>Place a call, connect to your agent, speak for a few moments to test
the audio, then end the call. Make sure the agent exits after call
work</p></li><li><p>After a minute or so, the recording should import.</p></li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="adding-contact-channel-analytics-to-the-service-console"></a>Adding Contact Channel Analytics to the Service Console<a class="hash-link" href="#adding-contact-channel-analytics-to-the-service-console" title="Direct link to heading">#</a></h4><ol><li><p>Log in into your Salesforce org and go to the <strong>Service Console</strong></p></li><li><p>Expand the <strong>navigation menu</strong> by selecting the down arrow and
choose <strong>Edit</strong>.</p></li></ol><img src="/img/lightning/image40.png"><ol start="3"><li>On the Edit Service Console App Navigation Items page, select <strong>Add
More Items</strong></li></ol><img src="/img/lightning/image41.png"><ol start="4"><li><p>Select the <strong>+</strong> next to <strong>AC Contact Channel Analytics</strong></p></li><li><p>Select <strong>Add 1 Nav Item</strong></p></li><li><p>Change the order of your Navigation Items if desired, then choose
<strong>Save</strong></p></li></ol><img src="/img/lightning/image203.png"><ol start="7"><li>Once the save completes, expand the <strong>navigation menu</strong> by selecting
the down arrow and choose <strong>AC Contact Channel Analytics</strong></li></ol><img src="/img/lightning/image204.png"><ol start="8"><li>Change the list view from Recently Viewed to <strong>All</strong></li></ol><img src="/img/lightning/image205.png"><ol start="9"><li>Once the view refreshes, you should see your record(s)</li></ol><img src="/img/lightning/image206.png"><ol start="10"><li><p>Select the recording to open it</p></li><li><p>In the Notes &amp; Attachments section, you will see the recording file
attached.</p></li></ol><img src="/img/lightning/image207.png"><ol start="12"><li>NOTE: The recording playback, waveform, and transcript views are
only active when you also choose to activate recording transcripts.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="recording-transcripts"></a>Recording Transcripts<a class="hash-link" href="#recording-transcripts" title="Direct link to heading">#</a></h3><p>Enabling the Recording Transcripts activates a process to run your
contact recordings through Amazon Transcribe which uses a deep learning
process to convert text to speech accurately and quickly. In addition,
this process also creates a visual waveform of the recording, enables
the in-app recording playback, and provides a visual representation of
the conversation.</p><p>Once enabled during the AWS Serverless Application Repository for
Salesforce, recording transcription is activated on a call by call basis
by adding a specific contact attribute. This attribute is used during
Contact Trace Record processing to trigger the transcription.</p><p>Make sure the Salesforce user accessing recording transcription are added to the AC_CallRecording permission set, as described in the previous section.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="enabling-recording-transcription"></a>Enabling recording transcription<a class="hash-link" href="#enabling-recording-transcription" title="Direct link to heading">#</a></h4><ol><li><p>Login to your Amazon Connect instance as an Administrator</p></li><li><p>From the left navigation, choose <strong>Routing</strong> then select <strong>Contact
flows</strong></p></li></ol><img src="/img/lightning/image201.png"><ol start="3"><li><p>Open the contact flow that you want to use to enable call
transcription. This contact flow must have Amazon Connect&#x27;s native
recording turned on, since the transcription is dependent on it.</p></li><li><p>In you contact flow, before you transfer to queue, add a new <strong>Set
contact attributes</strong> block</p></li><li><p>Configure the block to set two contact attributes as follows:</p><ol><li><p>Attribute 1: enables the transcription process</p><p>a. <strong>Destination key</strong>: postcallTranscribeEnabled</p><p>b. <strong>Value</strong>: true</p></li><li><p>Attribute 2: specifies the transcription language</p><p>-a. <strong>Destination key</strong>: postcallTranscribeLanguage</p><p>b. <strong>Value</strong>: en-US (See <a href="https://docs.aws.amazon.com/transcribe/latest/dg/API_StartTranscriptionJob.html#transcribe-StartTranscriptionJob-request-LanguageCode" target="_blank" rel="noopener noreferrer">Amazon Transcribe API
Reference</a>
for valid language codes)</p></li></ol></li></ol><img src="/img/lightning/image208.png"><ol start="6"><li><p><strong>Save</strong> the Set contact attributes block. Make sure it is
appropriately connected to your contact flow, and <strong>Publish</strong> the
flow.</p></li><li><p>Wait approximately 2 minutes to give the contact flow time to
publish.</p></li><li><p>Place a call, connect to your agent, speak for a few moments from
both the agent and the customer side to generate a good transcript,
then end the call. Make sure the agent exits after call work</p></li><li><p>The transcription will take at least as long as the call did. Wait
an appropriate amount of time for the transcription to be available.</p></li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="accessing-transcriptions"></a>Accessing transcriptions<a class="hash-link" href="#accessing-transcriptions" title="Direct link to heading">#</a></h4><ol><li><p>Log in into your Salesforce org and go to the <strong>Service Console</strong></p></li><li><p>Expand the <strong>navigation menu</strong> by selecting the down arrow and
choose AC Contact Channel Analytics. If you have not previously
added AC Contact Channel Analytics to the navigation menu, complete
the steps found in
<a href="#adding-contact-channel-analytics-to-the-service-console">Adding Contact Channel Analytics to the Service Console</a>.</p></li></ol><img src="/img/lightning/image209.png"><ol start="3"><li>Change the list view from Recently Viewed to <strong>All</strong></li></ol><img src="/img/lightning/image205.png"><ol start="4"><li>Once the view refreshes, you should see your record(s)</li></ol><img src="/img/lightning/image210.png"><ol start="5"><li><p>Select a record to view the details.</p></li><li><p>Once the record opens, note the recording waveform, playback
controls, and the visual version of the transcription</p></li></ol><img src="/img/lightning/image211.png"><ol start="7"><li>Also note that the transcriptions for each side of the conversation
are also included as attachments.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ai-driven-contact-analysis"></a>AI Driven Contact Analysis<a class="hash-link" href="#ai-driven-contact-analysis" title="Direct link to heading">#</a></h3><p>Enabling the AI Driven Contact Analysis function allows you to process
the transcribed text using <a href="https://aws.amazon.com/comprehend/" target="_blank" rel="noopener noreferrer">Amazon
Comprehend</a>. Amazon Comprehend is a
natural language processing service that uses machine learning to find
insights and relationships in text.</p><p>Once enabled during the AWS Serverless Application Repository for
Salesforce, contact analysis is activated on a call by call basis by
adding a specific contact attribute. This attribute is used during
Contact Trace Record processing to trigger the Amazon Comprehend task.</p><p>There are five functions available with the integration. Each function
is triggered by a code. You can use one code in your contact attribute,
or string multiple together as a comma separated list. The available
codes and their functions are:</p><ul><li><p><strong>snt = Sentiment Analysis</strong></p></li><li><p><strong>kw = Keyphrase Extraction</strong></p></li><li><p><strong>dl = Language Detection</strong></p></li><li><p><strong>ne = Custom Entities</strong></p></li><li><p><strong>syn = Syntax Analysis</strong></p></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="enabling-ai-driven-contact-analysis"></a>Enabling AI Driven Contact Analysis<a class="hash-link" href="#enabling-ai-driven-contact-analysis" title="Direct link to heading">#</a></h4><ol><li><p>Login to your Amazon Connect instance as an Administrator</p></li><li><p>From the left navigation, choose <strong>Routing</strong> then select <strong>Contact
flows</strong></p></li></ol><img src="/img/lightning/image201.png"><ol start="3"><li><p>Open the contact flow that you want to use to enable AI Driven
Contact Analytics. This contact flow must have Amazon Connect&#x27;s
native recording turned on, and transcription enabled as these are
both prerequisites for the analytics function.</p></li><li><p>In you contact flow, before you transfer to queue, add a new <strong>Set
contact attributes</strong> block</p></li><li><p>Configure the block to set a contact attribute as follows:</p><p>a. <strong>Destination key:</strong> postcallTranscribeComprehendAnalysis</p><p>b. <strong>Value:</strong> snt,dl,kw,syn</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">- In this example, we are performing sentiment analysis,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">language detection, and keyphrase</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">extraction</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></li></ol><img src="/img/lightning/image212.png"><ol start="6"><li><p><strong>Save</strong> the Set contact attributes block. Make sure it is
appropriately connected to your contact flow, and <strong>Publish</strong> the
flow.</p></li><li><p>Wait approximately 2 minutes to give the contact flow time to
publish.</p></li><li><p>Place a call, connect to your agent, speak for a few moments from
both the agent and the customer side to generate a good transcript,
then end the call. Make sure the agent exits after call work</p></li><li><p>The contact analysis runs after the transcription, which will take
at least as long as the call did. Wait an appropriate amount of time
for the analysis to be available.</p></li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="accessing-the-ai-driven-contact-analysis"></a>Accessing the AI Driven Contact Analysis<a class="hash-link" href="#accessing-the-ai-driven-contact-analysis" title="Direct link to heading">#</a></h4><ol><li><p>Log in into your Salesforce org and go to the <strong>Service Console</strong></p></li><li><p>Expand the <strong>navigation menu</strong> by selecting the down arrow and
choose AC Contact Channel Analytics. If you have not previously
added AC Contact Channel Analytics to the navigation menu, complete
the steps found in
<a href="#adding-contact-channel-analytics-to-the-service-console">Adding Contact Channel Analytics to the Service Console</a>.</p></li></ol><img src="/img/lightning/image209.png"><ol start="3"><li>Change the list view from Recently Viewed to <strong>All</strong></li></ol><img src="/img/lightning/image205.png"><ol start="4"><li>Once the view refreshes, you should see your record(s)</li></ol><img src="/img/lightning/image210.png"><ol start="5"><li><p>Select a record to view the details.</p></li><li><p>Once the record opens, note the Keywords, Sentiment, and Dominant
Language</p></li></ol><img src="/img/lightning/image213.png"></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/docs/lightning/04-salesforce-lambdas/04-contact-channel-analytics.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/lightning/04-salesforce-lambdas/03-real-time-metrics"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Amazon Connect Real-Time Metrics in Salesforce</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/lightning/04-salesforce-lambdas/05-contact-trace-record-import"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Contact Trace Record Import Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#call-recording-streaming" class="table-of-contents__link">Call Recording Streaming</a></li><li><a href="#recording-transcripts" class="table-of-contents__link">Recording Transcripts</a></li><li><a href="#ai-driven-contact-analysis" class="table-of-contents__link">AI Driven Contact Analysis</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
<script src="/styles.63fe7873.js"></script>
<script src="/runtime~main.eec41197.js"></script>
<script src="/main.55cc4497.js"></script>
<script src="/1.6559db8c.js"></script>
<script src="/2.e8dda1c7.js"></script>
<script src="/64.cd1f80ee.js"></script>
<script src="/65.b29e5dff.js"></script>
<script src="/935f2afb.6eac2d43.js"></script>
<script src="/17896441.b0393081.js"></script>
<script src="/49155d7d.9beab761.js"></script>
</body>
</html>