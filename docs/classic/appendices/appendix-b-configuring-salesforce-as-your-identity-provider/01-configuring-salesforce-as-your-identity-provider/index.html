<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<link rel="search" type="application/opensearchdescription+xml" title="Amazon Connect Salesforce CTI Adapter" href="/amazon-connect-salesforce-cti/opensearch.xml"><title data-react-helmet="true">Appendix B: Configuring Salesforce as Your Identity Provider | Amazon Connect Salesforce CTI Adapter</title><meta data-react-helmet="true" property="og:url" content="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/classic/appendices/appendix-b-configuring-salesforce-as-your-identity-provider/01-configuring-salesforce-as-your-identity-provider"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Appendix B: Configuring Salesforce as Your Identity Provider | Amazon Connect Salesforce CTI Adapter"><meta data-react-helmet="true" name="description" content="Amazon Connect supports Security Assertion Markup Language (SAML 2.0) to"><meta data-react-helmet="true" property="og:description" content="Amazon Connect supports Security Assertion Markup Language (SAML 2.0) to"><link data-react-helmet="true" rel="shortcut icon" href="/amazon-connect-salesforce-cti/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/classic/appendices/appendix-b-configuring-salesforce-as-your-identity-provider/01-configuring-salesforce-as-your-identity-provider"><link data-react-helmet="true" rel="alternate" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/classic/appendices/appendix-b-configuring-salesforce-as-your-identity-provider/01-configuring-salesforce-as-your-identity-provider" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/classic/appendices/appendix-b-configuring-salesforce-as-your-identity-provider/01-configuring-salesforce-as-your-identity-provider" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/amazon-connect-salesforce-cti/assets/css/styles.547e623d.css">
<link rel="preload" href="/amazon-connect-salesforce-cti/assets/js/runtime~main.c2d153aa.js" as="script">
<link rel="preload" href="/amazon-connect-salesforce-cti/assets/js/main.098b0b79.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/amazon-connect-salesforce-cti/"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="v5.18" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="v5.18" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">v5.18</b></a><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/lightning/notices">Lightning</a><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/classic/notices">Classic</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/other/earlier-versions">Earlier Versions</a><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/tree/main/pdf" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>PDF<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/amazon-connect-salesforce-cti/"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="v5.18" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="v5.18" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">v5.18</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/lightning/notices">Lightning</a></li><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/classic/notices">Classic</a></li><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/other/earlier-versions">Earlier Versions</a></li><li class="menu__list-item"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/tree/main/pdf" target="_blank" rel="noopener noreferrer" class="menu__link"><span>PDF<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/classic/notices">Notices</a></li><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/classic/release-notes">Release Notes</a></li><li class="menu__list-item"><a class="menu__link menuLinkText_2aKo">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/introduction/01-key-benefits-and-requirements">Key Benefits and Requirements</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2aKo">Installation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/installation/01-installation">Installing the CTI Adapter and Salesforce Lambdas</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/installation/02-guided-setup">Setting Up The CTI Adapter Using Guided Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/installation/03-managed-package-manual-setup">Setting Up The CTI Adapter Managed Package Manually</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/installation/04-salesforce-lambdas-manual-setup">Setting Up The Salesforce Lambdas Manually</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/installation/05-upgrading-from-an-earlier-version">Upgrading from an Earlier Version</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/installation/06-cti-adapter-installation-troubleshooting">CTI Adapter Installation Troubleshooting and Common Issues</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2aKo">CTI Adapter</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/01-cti-adapter-configuration">CTI Adapter Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/02-omnipresence-agent-state-sync">Omnipresence Agent State Sync</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/03-contact-attributes-display">Contact Attributes Display</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/04-call-recording-playback">Call Recording Playback</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/05-call-display-account-page">Call Display on the Account Page</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/06-outbound-campaign-calls">Outbound Campaign Calls</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/07-amazon-connect-reports">Amazon Connect Reports in Salesforce</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/08-cti-flows">CTI Flows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/09-localization">Localization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/10-cti-actions">CTI Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/11-recording-controls">Recording Controls</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/12-chat-widget-integration">Chat Widget Integration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/13-wisdom-integration">Wisdom Integration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/cti-adapter/14-voice-id">Voice Id</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2aKo">Salesforce Lambdas</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/salesforce-lambdas/01-contact-flow-salesforce-lambdas">Invoking the Amazon Connect Salesforce Lambda in a Contact Flow</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2aKo">Appendices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/appendices/appendix-a-cti-flow-sources-and-events/01-cti-flow-sources-and-events">Appendix A: CTI Flow Sources and Events</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/appendices/appendix-b-configuring-salesforce-as-your-identity-provider/01-configuring-salesforce-as-your-identity-provider">Appendix B: Configuring Salesforce as Your Identity Provider</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/appendices/appendix-c-cti-flow-examples/01-cti-flow-examples">Appendix C: CTI Flow Examples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/appendices/appendix-d-cti-flow-blocks/01-cti-flow-blocks">Appendix D: CTI Flow Blocks</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">Appendix B: Configuring Salesforce as Your Identity Provider</h1></header><p>Amazon Connect supports Security Assertion Markup Language (SAML 2.0) to
enable single sign on(SSO). Salesforce can act as a single sign on
identity provider to service providers, allowing end users to easily and
securely access many web and mobile applications with one login. By
establishing the SSO integration between Amazon Connect and Salesforce,
you will be able to seamlessly login to Salesforce and the same
credentials will be used to auto-login to Amazon Connect.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configuration"></a>Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="prerequisites"></a>Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h3><p>To complete the SSO integration between Salesforce and Amazon Connect,
you need:</p><ol><li><p>An Amazon Connect Instance configured for SAML authentication</p></li><li><p>Appropriate AWS permissions to create Identity and Access Management
(IAM) roles and policies</p></li><li><p>Administrator permissions for your Salesforce Org</p></li><li><p>Amazon Connect CTI Adapter AppExchange package installed and
configured</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configuring-salesforce-as-an-identity-provider"></a>Configuring Salesforce as an Identity Provider<a class="hash-link" href="#configuring-salesforce-as-an-identity-provider" title="Direct link to heading">#</a></h3><p>First, we need to enable Salesforce to act as an identity provider
(IdP). An IdP performs end user authentication and provides the
credentials to the requesting service provider. In this case, Salesforce
server as the IdP and Amazon Connect the service provider, while being
embedded in Salesforce.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setup-identity-provider--download-metadata"></a>Setup Identity Provider &amp; Download Metadata<a class="hash-link" href="#setup-identity-provider--download-metadata" title="Direct link to heading">#</a></h4><ol><li><p>Log in into your Salesforce org and go to <strong>Setup</strong>.</p></li><li><p>In the <strong>Quick Find</strong> field, type <strong>Identity Provider,</strong> then select
<strong>Identity Provider</strong> from the result list</p></li><li><p>Identity Provider may be enabled by default. If not, choose <strong>Enable
Identity Provider</strong>, then select the appropriate certificate and
select Save.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image306.png"><ol start="4"><li>Choose <strong>Download Metadata</strong> and save the file to your computer.</li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image307.png"><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configure-the-identity-provider-policy-and-role-in-the-aws-console"></a>Configure the Identity Provider, Policy, and Role in the AWS Console<a class="hash-link" href="#configure-the-identity-provider-policy-and-role-in-the-aws-console" title="Direct link to heading">#</a></h3><p>Next, you need to configure the identity provider (Salesforce) in the
AWS console and provide access to Amazon Connect via IAM policies and
roles. This allows AWS to acknowledge Salesforce as the identity
provider and to provide users authenticated through Salesforce with the
access required to login to Amazon Connect.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configure-the-identity-provider"></a>Configure the Identity Provider<a class="hash-link" href="#configure-the-identity-provider" title="Direct link to heading">#</a></h4><ol><li><p>Login to the <a href="https://console.aws.amazon.com/" target="_blank" rel="noopener noreferrer"><strong>AWS console</strong></a></p></li><li><p>Open the <a href="https://console.aws.amazon.com/iam/home" target="_blank" rel="noopener noreferrer">AWS identity and Access Management (IAM)
Console</a></p></li><li><p>Select <strong>Identity providers</strong></p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image308.png"><ol start="4"><li><p>Choose <strong>Create Provider</strong></p></li><li><p>On the Configure Provider screen, select <strong>SAML</strong> as the Provider
Type</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image309.png"><ol start="6"><li><p>Set the Provider Name to <strong>SalesforceConnect</strong></p></li><li><p>Import the metadata file you downloaded previously by selecting
Choose File and navigating to the downloaded metadata file.</p></li><li><p>Select Next Step</p></li><li><p>Choose Create</p></li><li><p>The Identity provider has been created</p></li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="create-the-iam-role-and-policy"></a>Create the IAM Role and Policy<a class="hash-link" href="#create-the-iam-role-and-policy" title="Direct link to heading">#</a></h4><ol><li><p>Login to the <a href="https://console.aws.amazon.com/" target="_blank" rel="noopener noreferrer"><strong>AWS console</strong></a></p></li><li><p>Open the <a href="https://console.aws.amazon.com/iam/home" target="_blank" rel="noopener noreferrer">AWS identity and Access Management (IAM)
Console</a></p></li><li><p>Select <strong>Roles,</strong> then choose <strong>Create role</strong></p></li><li><p>Choose <strong>SAML 2.0 federation</strong></p></li><li><p>In the SAML provider dropdown, select the provider you just created,
which should be named <strong>SalesforceConnect</strong></p></li><li><p>Select the radio button for <strong>Allow programmatic and AWS Management
Console access</strong>. The Attribute and Value fields should
auto-populate</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image310.png"><ol start="7"><li><p>Select <strong>Next: Permissions</strong></p></li><li><p>On the Attach permissions policies page, select <strong>Create policy.</strong>
This will open a new browser tab<strong>.</strong></p></li><li><p>Choose the <strong>JSON</strong> tab to switch to the JSON editor</p></li><li><p>Replace the existing JSON with the following:</p></li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;Version&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2012-10-17&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;Statement&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;Sid&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Statement1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;Effect&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Allow&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;Action&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;connect:GetFederationToken&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;Resource&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;**YOUR ARN**/user/${aws:userid}&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="11"><li><p>Replace **YOUR ARN** with the ARN of your Amazon Connect
instance. To find your Amazon Connect instance ARN:</p></li><li><p>Open a new tab in your browser and navigate to <a href="https://console.aws.amazon.com/connect/home" target="_blank" rel="noopener noreferrer">Amazon Connect
Console</a></p></li><li><p>Click on the name (alias) of your Amazon Connect instance</p></li><li><p>Copy the Instance ARN and paste it to your computer&#x27;s notepad (you
will use it in a few places)</p></li><li><p>Choose <strong>Review policy</strong></p></li><li><p>Set the Name to <strong>SalesforceConnectPolicy</strong></p></li><li><p>Select <strong>Create Policy</strong></p></li><li><p>Once the Policy has been created, close the tab, go back to the
original (Role) tab in your browser and select the <strong>Refresh</strong>
button (do not refresh the browser)</p></li><li><p>In the search field, enter <strong>SalesforceConnectPolicy</strong> and select
the box to attach the policy.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image311.png"><ol start="20"><li><p>Choose <strong>Next: Tags</strong> and set tags if desired, then choose <strong>Next:
Review</strong></p></li><li><p>Name the Role <strong>SalesforceConnectRole</strong> and provide a description if
you like</p></li><li><p>Select Create role</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="complete-the-base-salesforce-configuration"></a>Complete the Base Salesforce Configuration<a class="hash-link" href="#complete-the-base-salesforce-configuration" title="Direct link to heading">#</a></h3><p>Next, you need to configure a Connect App in Salesforce and provide
further configuration to complete the SAML integration.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="create-the-connected-app-in-salesforce"></a>Create the Connected App in Salesforce<a class="hash-link" href="#create-the-connected-app-in-salesforce" title="Direct link to heading">#</a></h4><ol><li><p>Log in into your Salesforce org and go to <strong>Setup</strong></p></li><li><p>In the <strong>Quick Find</strong> field, type <strong>Apps</strong> and select
<strong>Build-&gt;Create-&gt;Apps</strong></p></li><li><p>Select New Connected App</p></li><li><p>Provide a name for the Connected App, such as <strong>AmazonConnectSAML,</strong>
then press tab and the API Name should auto-populate</p></li><li><p>Provide an email contact address</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image312.png"><ol start="6"><li><p>In the Web App Settings section, choose <strong>Enable SAML</strong></p></li><li><p>Leave Start URL empty</p></li><li><p>Set Entity Id to the same name that you gave the Identity Provider
in the IAM console, which should be <strong>SalesforceConnect</strong></p></li><li><p>Set ACS URL as <strong><a href="https://signin.aws.amazon.com/saml" target="_blank" rel="noopener noreferrer">https://signin.aws.amazon.com/saml</a></strong></p></li><li><p>Set Subject Type as <strong>Persistent ID</strong></p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image313.png"><ol start="11"><li><p>Choose <strong>Save</strong>. The screen should refresh and the new Connected App
should be displayed</p></li><li><p>Scroll down to the <strong>Custom Attributes</strong> section and select <strong>New</strong></p></li><li><p>Set Key as
<strong><a href="https://aws.amazon.com/SAML/Attributes/RoleSessionName" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/SAML/Attributes/RoleSessionName</a></strong></p></li><li><p>Set Value as <strong>$User.Email</strong></p></li><li><p>Select <strong>Save</strong></p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image314.png"><ol start="16"><li><p>Select New again to configure another custom attribute</p></li><li><p>Set Key as <strong><a href="https://aws.amazon.com/SAML/Attributes/Role" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/SAML/Attributes/Role</a></strong></p></li><li><p>The Value is going to be a combination of the Indentity Provider and
IAM Role ARNs.</p><p>a.  In a new tab, open the <a href="https://console.aws.amazon.com/iam/home" target="_blank" rel="noopener noreferrer">AWS identity and Access Management (IAM)
Console</a></p><p>b.  On the left navigation, select <strong>Identity providers</strong></p><p>c.  Select the Identity provider you created earlier, which should
be named <strong>SalesforceConnect</strong></p><p>d.  Copy the <strong>Provider ARN</strong> to your computer&#x27;s notepad</p><p>e.  Return to the IAM console and select <strong>Roles</strong></p><p>f.  Select the Role you created earlier, which should be
<strong>SalesforceConnectRole</strong></p><p>g.  Copy the <strong>Role ARN</strong> to your computer&#x27;s notepad</p><p>h.  Format the combined value as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&#x27;Identity Provider ARN&#x27; &amp; &#x27;,&#x27; &amp; &#x27;Role ARN&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>i.  Paste the formatted value into the Custom Attribute Value</p></li><li><p>Select <strong>Save</strong></p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image315.png"><ol start="20"><li><p>At the top of the Connected App description, select <strong>Manage</strong></p></li><li><p>Scroll down to the <strong>SAML login Information</strong> section</p></li><li><p>Copy the <strong>IdP-Initiated Login URL</strong> to your computer&#x27;s notepad</p></li><li><p>Scroll down to find the Profiles section, then select <strong>Manage
Profiles</strong></p></li><li><p>Select a profile from the list, for example System Administrator for
testing purposes</p></li><li><p>Choose <strong>Save</strong></p></li><li><p>Open a new tab in your browser and navigate to IdP-Initiated Login
URL that you copied in an earlier step</p></li><li><p>The browser will redirect to AWS Console and log you in
automatically as a federated user
<strong>Note:</strong> you may be able to see AWS services, but you should have
no configuration rights.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image316.png"><ol start="28"><li><p>The Federated Login consists of the Role name and your Salesforce
email address.</p></li><li><p>Initial validation is complete</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="complete-the-amazon-connect-configuration"></a>Complete the Amazon Connect Configuration<a class="hash-link" href="#complete-the-amazon-connect-configuration" title="Direct link to heading">#</a></h3><p>The last step in the SAML setup is to add users to Amazon Connect that
exist in your Salesforce org, then validate login. It is critical that
the usernames for both platforms match exactly.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="add-users-to-amazon-connect"></a>Add Users to Amazon Connect<a class="hash-link" href="#add-users-to-amazon-connect" title="Direct link to heading">#</a></h4><ol><li><p>In a new browser tab, login to the <a href="https://console.aws.amazon.com/" target="_blank" rel="noopener noreferrer">AWS
console</a></p></li><li><p>Open the <a href="https://console.aws.amazon.com/connect/home" target="_blank" rel="noopener noreferrer">Amazon Connect
Console</a></p></li><li><p>Select the name (alias) of your Amazon Connect instance</p></li><li><p>Choose <strong>Login as administrator</strong></p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image317.png"><ol start="5"><li><p>Within the Amazon Connect administration portal, select <strong>Users</strong>
then choose <strong>User Management</strong></p></li><li><p>Click <strong>Add New Users</strong></p></li><li><p>Leave <strong>Create and setup a new user</strong> selected and choose <strong>Next</strong></p></li><li><p>Complete the First and Last name fields as appropriate</p></li><li><p>Set the login name to match the <strong>Email Address</strong> of your Salesforce
user</p></li><li><p>Set the <strong>Routing Profile</strong>. In this example, the default Basic
Routing Profile is shown</p></li><li><p>Set the <strong>Security Profile</strong>. In this example, <em>Admin</em> is shown</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image318.png"><ol start="12"><li><p>Select <strong>Save</strong></p></li><li><p>Select <strong>Create Users</strong></p></li><li><p>Repeat this process as required for your staff</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="final-configuration-for-the-lightning-experience"></a>Final Configuration for the Lightning Experience<a class="hash-link" href="#final-configuration-for-the-lightning-experience" title="Direct link to heading">#</a></h3><p>Now that all of the underlying pieces are in place, the last steps are
to create the Amazon Connect Single Sign On URL and validate that it
works correctly, then configure the Lightning CTI adapter and login the
agent.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="create-the-amazon-connect-sso-url"></a>Create the Amazon Connect SSO URL<a class="hash-link" href="#create-the-amazon-connect-sso-url" title="Direct link to heading">#</a></h4><p>You create the Amazon Connect SSO URL by combining the IdP-Initiated
Login URL that you copied earlier, and a relay state URL that will
redirect the authenticated user to your Amazon Connect instance.</p><p>The &#x27;RelayState&#x27; will be in the following format:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">https://console.aws.amazon.com/connect/federate/[object Object]?destination=%2Fconnect%2Fccp</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Please note that &quot;console.aws.amazon.com&quot; refers to US-East-1 region (N.
Virginia). If your Amazon Connect instance is in a different region,
please use the region Console URL. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">https://us-west-2.console.aws.amazon.com/connect/federate/[object Object]?destination=%2Fconnect%2Fccp</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol><li><p>To begin, format the relay state URL by replacing InstanceId
with your Instance Id. To find your Amazon Connect Instance Id:</p><p>a.  Open a new tab in your browser and navigate to the <a href="https://console.aws.amazon.com/connect/home" target="_blank" rel="noopener noreferrer">Amazon
Connect Console</a></p><p>b.  Click on the name (alias) of your Amazon Connect</p><p>c.  From the Instance ARN, copy the portion after the &#x27;/&#x27;. This is
the Instance Id</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image319.png"><ol start="2"><li>Concatenate the &#x27;IdP-Initiated Login URL&#x27; and the &#x27;RelayState&#x27;, by
combining the two with &quot;&amp;RelayState=&quot; in between, for example:</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">https://mXXXXXXrun-dev-ed.my.salesforce.com/idp/login?app=0sp0N000000Caid&amp;RelayState=https://console.aws.amazon.com/connect/federate/[object Object]?destination=%2Fconnect%2Fccp</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="3"><li><p>This is the Final SSO URL, needed for the Amazon Connect Lightning
CTI Adapter Configuration.</p></li><li><p>To validate this URL:</p><p>a.  Open a new tab in the same browser that you are logged into
Salesforce</p><p>b.  Paste the fully concatenated URL into the new browser and press
enter</p><p>c.  You should automatically login and be redirected to the Amazon
Connect Contact Control Panel.</p></li><li><p>Once you validate the full URL, you are ready to add it to the
Lightning Adapter</p></li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configure-the-cti-lightning-adapter-in-salesforce-for-sso"></a>Configure the CTI Lightning Adapter in Salesforce For SSO<a class="hash-link" href="#configure-the-cti-lightning-adapter-in-salesforce-for-sso" title="Direct link to heading">#</a></h4><p>Now we are ready to complete the last step in the configuration process:
Adding the SSO settings for Salesforce to the Lightning Adapter. This
will configure the adapter to authenticate via SSO and redirect to the
Amazon Connect Contact Control Panel once authentication completes.</p><ol><li><p>Log in into your Salesforce org and go to the <strong>Service Console</strong></p></li><li><p>Expand the <strong>navigation menu</strong> by selecting the down arrow and
choose <strong>AC CTI Adapters</strong>.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image83.png"><ol start="3"><li><p>Select <strong>ACLightningAdapter</strong></p></li><li><p>Scroll down to the Single SignOn (SSO) section and choose the pencil
icon of either field to edit</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image84.png"><ol start="5"><li><p>For the SSO Url, copy the first part of the SSO URL that you created
previously, up to the first question mark (do not copy the question
mark), for example:</p><p><code>https://mXXXXXXrun-dev-ed.my.salesforce.com/idp/login?app=0sp0N000000Caid&amp;RelayState=https://console.aws.amazon.com/connect/federate/&lt;b&gt;InstanceId&lt;/b&gt;?destination=%2Fconnect%2Fccp</code></p></li><li><p>Paste this portion of the URL into the <strong>SSO Url</strong> field</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image85.png"><ol start="7"><li><p>For the SSO Relay State, copy everything AFTER the question mark (do
not copy the question mark), for example:</p><p><code>https://mXXXXXXrun-dev-ed.my.salesforce.com/idp/login?app=0sp0N000000Caid&amp;RelayState=https://console.aws.amazon.com/connect/federate/&lt;b&gt;InstanceId&lt;/b&gt;?destination=%2Fconnect%2Fccp</code></p></li><li><p>Paste this portion of the URL into the <strong>SSO Relay State</strong> field</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image86.png"><ol start="9"><li>Choose <strong>Save</strong></li></ol><blockquote><p><strong>Note: With the new Amazon Connect instance urls (<code>*.my.connect.aws</code>) you must put the full URL into the <code>Amazon Connect Instance</code> field in the AC CTI Adapter record for SSO to work. Ex: using <code>https://myinstance.my.connect.aws</code> instead of <code>my instance</code>.</strong></p></blockquote><ol start="10"><li><p><strong>Refresh</strong> your browser to make the changes take effect</p><p>a.  <strong>NOTE:</strong> If you receive a blocked popup warning, select the
warning and change the setting to always allow popups from your
Salesforce org, then refresh the browser again</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image87.png"><ol start="11"><li>After a few seconds, a new window should pop up for a moment. This
window is performing the authentication and setting your session
cookie. Once it does this, it will close automatically.</li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image88.png"><ol start="12"><li><p>Once the authentication window closes, select the <strong>phone icon</strong> in
the console toolbar to open the CCP
Note: You may also receive popups to allow notifications and
microphone access. Please accept both.</p></li><li><p>You should now see the authenticated and logged in CCP</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/image89.png"><p>Configuration is complete</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/docs/classic/05-appendices/02-appendix-b-configuring-salesforce-as-your-identity-provider/01-configuring-salesforce-as-your-identity-provider.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/amazon-connect-salesforce-cti/docs/classic/appendices/appendix-a-cti-flow-sources-and-events/01-cti-flow-sources-and-events"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Appendix A: CTI Flow Sources and Events</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/amazon-connect-salesforce-cti/docs/classic/appendices/appendix-c-cti-flow-examples/01-cti-flow-examples"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Appendix C: CTI Flow Examples Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#configuration" class="table-of-contents__link">Configuration</a><ul><li><a href="#prerequisites" class="table-of-contents__link">Prerequisites</a></li><li><a href="#configuring-salesforce-as-an-identity-provider" class="table-of-contents__link">Configuring Salesforce as an Identity Provider</a></li><li><a href="#configure-the-identity-provider-policy-and-role-in-the-aws-console" class="table-of-contents__link">Configure the Identity Provider, Policy, and Role in the AWS Console</a></li><li><a href="#complete-the-base-salesforce-configuration" class="table-of-contents__link">Complete the Base Salesforce Configuration</a></li><li><a href="#complete-the-amazon-connect-configuration" class="table-of-contents__link">Complete the Amazon Connect Configuration</a></li><li><a href="#final-configuration-for-the-lightning-experience" class="table-of-contents__link">Final Configuration for the Lightning Experience</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
<script src="/amazon-connect-salesforce-cti/assets/js/runtime~main.c2d153aa.js"></script>
<script src="/amazon-connect-salesforce-cti/assets/js/main.098b0b79.js"></script>
</body>
</html>