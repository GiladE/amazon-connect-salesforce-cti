<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/amazon-connect-salesforce-cti/blog/rss.xml" title="Amazon Connect Salesforce CTI Adapter Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/amazon-connect-salesforce-cti/blog/atom.xml" title="Amazon Connect Salesforce CTI Adapter Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Amazon Connect Salesforce CTI Adapter" href="/amazon-connect-salesforce-cti/opensearch.xml"><title data-react-helmet="true">Call Recording Link for Task | Amazon Connect Salesforce CTI Adapter</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Call Recording Link for Task | Amazon Connect Salesforce CTI Adapter"><meta data-react-helmet="true" name="description" content="The Adapter comes with a Visualforce component that provides users with"><meta data-react-helmet="true" property="og:description" content="The Adapter comes with a Visualforce component that provides users with"><meta data-react-helmet="true" property="og:url" content="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/04-call-recording-link-for-task"><link data-react-helmet="true" rel="shortcut icon" href="/amazon-connect-salesforce-cti/img/favicon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/04-call-recording-link-for-task"><link rel="stylesheet" href="/amazon-connect-salesforce-cti/styles.9b76b2ee.css">
<link rel="preload" href="/amazon-connect-salesforce-cti/styles.e81f72f2.js" as="script">
<link rel="preload" href="/amazon-connect-salesforce-cti/runtime~main.27a7a985.js" as="script">
<link rel="preload" href="/amazon-connect-salesforce-cti/main.925d2be1.js" as="script">
<link rel="preload" href="/amazon-connect-salesforce-cti/1.ea6a68ea.js" as="script">
<link rel="preload" href="/amazon-connect-salesforce-cti/2.d39c7868.js" as="script">
<link rel="preload" href="/amazon-connect-salesforce-cti/65.d4745188.js" as="script">
<link rel="preload" href="/amazon-connect-salesforce-cti/68.40dfeccf.js" as="script">
<link rel="preload" href="/amazon-connect-salesforce-cti/935f2afb.dbd28629.js" as="script">
<link rel="preload" href="/amazon-connect-salesforce-cti/17896441.cba02fd0.js" as="script">
<link rel="preload" href="/amazon-connect-salesforce-cti/260e5f86.c2443380.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/amazon-connect-salesforce-cti/"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="Amazon Connect Salesforce CTI Adapter" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="Amazon Connect Salesforce CTI Adapter" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Amazon Connect Salesforce CTI Adapter</strong></a><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/lightning/notices">Lightning</a><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/classic/notices">Classic</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/tree/main/pdf" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">PDF</a><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/amazon-connect-salesforce-cti/"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="Amazon Connect Salesforce CTI Adapter" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="Amazon Connect Salesforce CTI Adapter" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Amazon Connect Salesforce CTI Adapter</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/lightning/notices">Lightning</a></li><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/classic/notices">Classic</a></li><li class="menu__list-item"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/tree/main/pdf" target="_blank" rel="noopener noreferrer" class="menu__link">PDF</a></li><li class="menu__list-item"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/classic/notices">Notices</a></li><li class="menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/classic/release-notes">Release Notes</a></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/01-introduction/01-key-benefits-and-requirements">Key Benefits and Requirements</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Installation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/02-installation/01-installing-the-amazon-connect-cti-adapter">Installing the Amazon Connect CTI Adapter for Salesforce Package</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/02-installation/02-installing-the-amazon-connect-salesforce-lambdas">Installing the Amazon Connect Salesforce Lambda Package</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/02-installation/03-upgrading-from-an-earlier-version">Upgrading from an Earlier Version</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/02-installation/04-cti-adapter-installation-troubleshooting">CTI Adapter Installation Troubleshooting and Common Issues</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">CTI Adapter</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/01-cti-adapter-configuration">CTI Adapter Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/02-omnipresence-agent-state-sync">Omnipresence Agent State Sync</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/03-contact-attributes-display">Contact Attributes Display</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/04-call-recording-link-for-task">Call Recording Link for Task</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/05-call-display-account-page">Call Display on the Account Page</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/06-outbound-campaign-calls">Outbound Campaign Calls</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/07-amazon-connect-reports">Amazon Connect Reports in Salesforce</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/08-cti-flows">CTI Flows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/09-localization">Localization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/10-cti-actions">CTI Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/11-recording-controls">Recording Controls</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Salesforce Lambdas</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/04-salesforce-lambdas/01-contact-flow-salesforce-lambdas">Invoking the Amazon Connect Salesforce Lambda in a Contact Flow</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Appendices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/05-appendices/01-appendix-a-cti-flow-sources-and-events/01-cti-flow-sources-and-events">Appendix A: CTI Flow Sources and Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/05-appendices/02-appendix-b-configuring-salesforce-as-your-identity-provider/01-configuring-salesforce-as-your-identity-provider">Appendix B: Configuring Salesforce as Your Identity Provider</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/05-appendices/03-appendix-c-cti-flow-examples/01-cti-flow-examples">Appendix C: CTI Flow Examples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/classic/05-appendices/04-appendix-d-cti-flow-blocks/01-cti-flow-blocks">Appendix D: CTI Flow Blocks</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Call Recording Link for Task</h1></header><div class="markdown"><p>The Adapter comes with a Visualforce component that provides users with
the ability to download a call recording created within Amazon Connect
from a Salesforce page.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cloudformation-template"></a>Cloudformation Template<a class="hash-link" href="#cloudformation-template" title="Direct link to heading">#</a></h5><p>To make sure that the AWS resources are set up, make sure that the
<em>PostcallRecordingImportEnabled</em> parameter is set to true in your
Cloudformation stack:</p><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming0.png"><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="aws-side-setup"></a>AWS Side Setup<a class="hash-link" href="#aws-side-setup" title="Direct link to heading">#</a></h5><ol><li><p>See <a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-trusted-signers.html" target="_blank" rel="noopener noreferrer">these steps</a>. Follow the sections <em>Creating key pairs for your signers</em>, and <em>Adding a signer to a distribution</em>.
Make sure to record the <strong>public key ID</strong>.</p></li><li><p>Copy and paste the contents of the private key .pem file into a text editor. Replace every newline character with a space, and then delete the last character. This is most easily done using a &quot;find and replace&quot; feature in your text editor.
The resulting string of text should resemble the following:</p></li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">-----BEGIN RSA PRIVATE KEY----- (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (under 64 character string) -----END RSA PRIVATE KEY-----</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol start="3"><li><p>Navigate to the &quot;Secrets Manager&quot; service. Select the <strong>SalesforceCredentials</strong>.</p></li><li><p>Under the &quot;Secret value&quot; tab, select &quot;Retrieve secret value&quot; and then &quot;Edit&quot;.</p></li><li><p>For the <strong>CloudFrontPrivateKey</strong> field, copy and paste the modified contents of the private key .pem file. For the <strong>CloudFrontAccessKeyID</strong> field, copy and paste the <strong>Access Key Id</strong> you recorded above. Your Secrets Manager Secret should look like the following:</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming1.png"><p>Please note that your secret may also be formatted stored as a &quot;Secret key/value&quot; secret rather than a &quot;Plaintext&quot; secret; both secret types are valid.</p><ol start="6"><li>Navigate to your Salesforce instance. Navigate to setup, then search for &quot;Visualforce pages.&quot;</li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming2.png"><ol start="7"><li><p>Select the <strong>ACSFCCP_CallRecordingTask</strong> visualforce page, and select &quot;preview.&quot; Copy the url of the opened page up until <code>.com</code>. Make sure not to include any characters after <code>.com</code>.</p></li><li><p>Navigate back to aws, to the s3 bucket where your audio recording files are stored. This s3 bucket should be the same bucket as the <strong>ConnectRecordingS3BucketName</strong> parameter to the serverless application.</p></li><li><p>In the bucket details, select the <strong>Permissions</strong> tab and then the <strong>CORS configuration</strong> tab and paste the following. Replace the AllowedOrigin with the url copied in step 9.</p></li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;AllowedHeaders&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;AllowedMethods&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;GET&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;AllowedOrigins&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;{url copied in step 9}&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;ExposeHeaders&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><img src="/amazon-connect-salesforce-cti/img/lightning/image271.png"><ol start="10"><li><p>Select Save</p></li><li><p>Navigate to the &quot;IAM&quot; aws service. Select <strong>Add User</strong>.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming4.png"><ol start="12"><li>Give your IAM user a name, like <strong>sfInvokeGenerateAudioRecordingStreamingURLIAMUser</strong>. For the &quot;AWS Access Type&quot;, select <strong>Programmatic access</strong>.</li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming5.png"><ol start="13"><li><p>Select Next, then select &quot;Attach existing policies directly.&quot; Search for <strong>invokeSfGenerateAudioRecordingStreamingURLPolicy</strong> and select it.</p></li><li><p>Create the user, then copy down the <strong>Access key ID</strong> and the <strong>Secret access key</strong>. These keys will be used in the next section.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming6.png"><ol start="15"><li>Navigate to the &quot;Lambda&quot; aws service. Search for term &quot;sfgenerate&quot; and copy down the full name of the sfGenerateAudioRecordingStreaming lambda. This will be used in the next section.</li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming7.png"><ol start="16"><li>Navigate back to the &quot;Lambda&quot; aws service main page and navigate to the <strong>us-east-1 region</strong>. Select <strong>create function</strong>.</li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming8.png"><ol start="17"><li><p>Enter a function name, like <strong>sfSig4RequestToS3</strong>.</p></li><li><p>Select <strong>change default execution role</strong>, and <strong>use an existing role</strong>. Search for and select <em>sfSig4RequestToS3Role</em>.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming9.png"><ol start="19"><li><p>Select <strong>create function</strong>. On the next screen, copy and paste the contents from <a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/blob/main/docs/lightning/04-salesforce-lambdas/sfSig4RequestToS3.js" target="_blank" rel="noopener noreferrer">this file</a> into the function body, and then select <strong>Deploy</strong>.</p></li><li><p>Select the actions dropdown, and then select <strong>Deploy to Lambda@Edge</strong>.</p></li><li><p>Select the Cloudfront Distribution that was created by the Salesfore Lambdas serverless application, then check off the &quot;I acknowledge...&quot; check box, then select deploy.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming10.png"><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="salesforce-side-setup"></a>Salesforce Side Setup<a class="hash-link" href="#salesforce-side-setup" title="Direct link to heading">#</a></h5><ol><li><p>In Salesforce Setup, search for &quot;Named Credentials.&quot; Select <strong>New Named Credential.</strong></p></li><li><p>For the <strong>Name</strong> and <strong>Label</strong>, enter AwsGenerateAudioRecordingURL.</p></li><li><p>In the <strong>URL</strong> section, enter <code>https://lambda.{awsRegion}.amazonaws.com/2015-03-31/functions/{lambdaFunctionName}/invocations/</code>-- replace {awsRegion} with the awsRegion your serverless application resides in (for example, us-east-1), and replace {lambdaFunctionName} with the full name of the sfGenerateAudioRecordingStreaming lambda you recorded in the previous section.</p></li><li><p>For <strong>Identity Type</strong> select <strong>Named Principal</strong>. For the <strong>Authentication Protocol</strong>, select <strong>AWS Signature Version 4</strong>. Fill in the <strong>Access key ID</strong> you recorded in the previous section as &quot;AWS Access Key ID&quot;, the <strong>Secret access key</strong> as the &quot;AWS Secret Access Key&quot;, the AWS Region, and &quot;lambda&quot; as the &quot;AWS Service.&quot;</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming11.png"><ol start="5"><li>Select <strong>save</strong>.</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="enabling-call-recording-streaming"></a>Enabling call recording streaming<a class="hash-link" href="#enabling-call-recording-streaming" title="Direct link to heading">#</a></h4><ol><li><p>Login to your Amazon Connect instance as an Administrator</p></li><li><p>From the left navigation, choose <strong>Routing</strong> then select <strong>Contact
flows</strong></p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming12.png"><ol start="3"><li><p>Open the contact flow that you want to use to enable call recording
import. This contact flow must have Amazon Connect&#x27;s native
recording turned on.</p></li><li><p>In you contact flow, before you transfer to queue, add a new <strong>Set
contact attributes</strong> block</p></li><li><p>Configure the block to set a contact attribute as follows:</p><p>a. <strong>Destination key:</strong> postcallRecordingImportEnabled</p><p>b. <strong>Value:</strong> true</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming13.png"><ol start="6"><li><p><strong>Save</strong> the Set contact attributes block. Make sure it is
appropriately connected to your contact flow, and <strong>Publish</strong> the
flow.</p></li><li><p>Wait approximately 2 minutes to give the contact flow time to
publish.</p></li></ol><p>To edit the sample Task Page Layout, please follow the steps:</p><ol><li><p>Log in to your Salesforce Org</p></li><li><p>Navigate to <strong>Setup</strong> then in type <em>Object Manager</em> in Quick Find</p></li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming14.png"><ol start="3"><li>Click on the &quot;Task&quot; object</li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming15.png"><ol start="4"><li>Click on the &quot;Page Layouts&quot;</li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming16.png"><ol start="5"><li>Click on the &quot;<em>Task Layout</em>&quot; and the layout designer will open</li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming17.png"><ol start="6"><li>Drag the &quot;ACSFCCP_CallRecording&quot; item to the desired are of the layout to have that information appear on the agent&#x27;s screen. The following screenshot shows how the Call Details section could appear when placing the &quot;ACSFCCP_CallRecording&quot; item on the required Task layout.</li></ol><img src="/amazon-connect-salesforce-cti/img/classic/audiostreaming18.png"><ol start="7"><li>To have access to the recording, the user must have an active session with Amazon Connect. This can be achieved by either logging in to the CCP softphone, or by logging in to Amazon Connect outside of Salesforce. After the session is established, a page refresh should make the player appear.</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="common-audio-streaming-setup-issues"></a>Common Audio Streaming Setup Issues<a class="hash-link" href="#common-audio-streaming-setup-issues" title="Direct link to heading">#</a></h4><ol><li><p>Verify that the Secrets Manager secret contains both the <code>CloudFrontPrivateKey</code> and <code>CloudFrontAccessKeyID</code> items.</p></li><li><p>Verify that your Cloudfront distribution&#x27;s behavior is set to use <code>Trusted Key Groups</code>, and that the correct Key Group is selected.</p></li></ol><img src="/amazon-connect-salesforce-cti/img/shared/audiostreamingkeygroups.png"><ol start="3"><li>Verify that your Cloudfront distribution&#x27;s behavior contains the sfSig4RequestToS3 edge lambda</li></ol><img src="/amazon-connect-salesforce-cti/img/shared/audiostreamingedgelambda.png"><ol start="4"><li>Verify that your S3 bucket CORS configuration is correct</li></ol><img src="/amazon-connect-salesforce-cti/img/shared/audiostreamingcorsconfiguration.png"><ol start="5"><li><p>Verify that your named credentials are correctly set up</p></li><li><p>Verify that your user is added to the AC_CallRecording permission set</p></li></ol></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/04-call-recording-link-for-task.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/03-contact-attributes-display"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Contact Attributes Display</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/amazon-connect-salesforce-cti/docs/classic/03-cti-adapter/05-call-display-account-page"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Call Display on the Account Page Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
<script src="/amazon-connect-salesforce-cti/styles.e81f72f2.js"></script>
<script src="/amazon-connect-salesforce-cti/runtime~main.27a7a985.js"></script>
<script src="/amazon-connect-salesforce-cti/main.925d2be1.js"></script>
<script src="/amazon-connect-salesforce-cti/1.ea6a68ea.js"></script>
<script src="/amazon-connect-salesforce-cti/2.d39c7868.js"></script>
<script src="/amazon-connect-salesforce-cti/65.d4745188.js"></script>
<script src="/amazon-connect-salesforce-cti/68.40dfeccf.js"></script>
<script src="/amazon-connect-salesforce-cti/935f2afb.dbd28629.js"></script>
<script src="/amazon-connect-salesforce-cti/17896441.cba02fd0.js"></script>
<script src="/amazon-connect-salesforce-cti/260e5f86.c2443380.js"></script>
</body>
</html>