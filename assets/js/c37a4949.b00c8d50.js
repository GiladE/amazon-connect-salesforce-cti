(self.webpackChunkamazon_connect_salesforce_cti=self.webpackChunkamazon_connect_salesforce_cti||[]).push([[4435],{3905:function(e,t,a){"use strict";a.d(t,{Zo:function(){return m},kt:function(){return k}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},m=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),g=s(a),k=r,h=g["".concat(p,".").concat(k)]||g[k]||c[k]||i;return a?n.createElement(h,o(o({ref:t},m),{},{components:a})):n.createElement(h,o({ref:t},m))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=g;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=a[s];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}g.displayName="MDXCreateElement"},3919:function(e,t,a){"use strict";function n(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!n(e)}a.d(t,{b:function(){return n},Z:function(){return r}})},4996:function(e,t,a){"use strict";a.d(t,{C:function(){return i},Z:function(){return o}});var n=a(2263),r=a(3919);function i(){var e=(0,n.Z)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,a=void 0===t?"/":t,i=e.url;return{withBaseUrl:function(e,t){return function(e,t,a,n){var i=void 0===n?{}:n,o=i.forcePrependBaseUrl,l=void 0!==o&&o,p=i.absolute,s=void 0!==p&&p;if(!a)return a;if(a.startsWith("#"))return a;if((0,r.b)(a))return a;if(l)return t+a;var m=a.startsWith(t)?a:t+a.replace(/^\//,"");return s?e+m:m}(i,a,e,t)}}}function o(e,t){return void 0===t&&(t={}),(0,i().withBaseUrl)(e,t)}},9793:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return p},contentTitle:function(){return s},metadata:function(){return m},toc:function(){return c},default:function(){return k}});var n=a(2122),r=a(9756),i=(a(7294),a(3905)),o=a(4996),l=["components"],p={id:"02-guided-setup",title:"Setting Up The CTI Adapter Using Guided Setup"},s=void 0,m={unversionedId:"lightning/installation/02-guided-setup",id:"lightning/installation/02-guided-setup",isDocsHomePage:!1,title:"Setting Up The CTI Adapter Using Guided Setup",description:"In order to navigate to the Guided Setup feature, perform the following steps (NOTE",source:"@site/docs/lightning/02-installation/02-guided-setup.md",sourceDirName:"lightning/02-installation",slug:"/lightning/installation/02-guided-setup",permalink:"/amazon-connect-salesforce-cti/docs/lightning/installation/02-guided-setup",editUrl:"https://github.com/amazon-connect/amazon-connect-salesforce-cti/docs/lightning/02-installation/02-guided-setup.md",version:"current",sidebarPosition:2,frontMatter:{id:"02-guided-setup",title:"Setting Up The CTI Adapter Using Guided Setup"},sidebar:"lightning",previous:{title:"Installing the CTI Adapter and Salesforce Lambdas",permalink:"/amazon-connect-salesforce-cti/docs/lightning/installation/01-installation"},next:{title:"Setting Up The CTI Adapter Managed Package Manually",permalink:"/amazon-connect-salesforce-cti/docs/lightning/installation/03-managed-package-manual-setup"}},c=[{value:"Guided Setup Prerequisites",id:"guided-setup-prerequisites",children:[{value:"Create Named Credential",id:"create-named-credential",children:[]},{value:"Create Connected App",id:"create-connected-app",children:[]}]},{value:"Guided Setup Additional Instructions",id:"guided-setup-additional-instructions",children:[{value:"Retrieve Amazon Connect Instance Url",id:"retrieve-amazon-connect-instance-url",children:[]},{value:"Add users to the Call Center",id:"add-users-to-the-call-center",children:[]},{value:"Add users to a Permission Set",id:"add-users-to-a-permission-set",children:[]},{value:"Configure the Toolkit settings",id:"configure-the-toolkit-settings",children:[]},{value:"Create the Softphone Layout",id:"create-the-softphone-layout",children:[]},{value:"Retrieve the Salesforce API Version",id:"retrieve-the-salesforce-api-version",children:[]},{value:"Setting up the Salesforce API User",id:"setting-up-the-salesforce-api-user",children:[]},{value:"Setting up the SecretsManager Secret",id:"setting-up-the-secretsmanager-secret",children:[]},{value:"Test the Salesforce Lambda Core Functionality",id:"test-the-salesforce-lambda-core-functionality",children:[]},{value:"Allow Amazon Connect to Access the sfInvokeAPI Lambda Function",id:"allow-amazon-connect-to-access-the-sfinvokeapi-lambda-function",children:[]},{value:"Create Public/Private key pair for the Cloudfront distribution",id:"create-publicprivate-key-pair-for-the-cloudfront-distribution",children:[]},{value:"Add Private Key, Access Key to Secrets Manager Secret",id:"add-private-key-access-key-to-secrets-manager-secret",children:[]}]}],g={toc:c};function k(e){var t=e.components,a=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,n.Z)({},g,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("img",{src:(0,o.Z)("/img/shared/guidedsetup0.png")}),(0,i.kt)("p",null,"In order to navigate to the Guided Setup feature, perform the following steps (NOTE: If you are not an admin user then you must first add yourself to the AC_Administrator permission set, see ",(0,i.kt)("a",{parentName:"p",href:"./02-guided-setup#add-users-to-a-permission-set"},"here")," for more details):"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate to the Service Console in your Salesforce instance.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click the drawdown button in the Service Console navigation bar, and select ",(0,i.kt)("strong",{parentName:"p"},"Edit"),"."))),(0,i.kt)("img",{src:(0,o.Z)("/img/shared/guidedsetup1.png")}),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},"In the proceeding popup, select ",(0,i.kt)("strong",{parentName:"li"},"Add More Items"),".")),(0,i.kt)("img",{src:(0,o.Z)("/img/shared/guidedsetup2.png")}),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click the ",(0,i.kt)("strong",{parentName:"p"},"+")," button next to ",(0,i.kt)("strong",{parentName:"p"},"AC Guided Setup"),", then add the item and ",(0,i.kt)("strong",{parentName:"p"},"save"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the newly added ",(0,i.kt)("strong",{parentName:"p"},"AC Guided Setup")," button in the drawdown menu."))),(0,i.kt)("img",{src:(0,o.Z)("/img/shared/guidedsetup3.png")}),(0,i.kt)("h2",{id:"guided-setup-prerequisites"},"Guided Setup Prerequisites"),(0,i.kt)("p",null,"The below sections are linked to from the Guided Setup feature. Only perform the below steps when the\nGuided Setup feature links to them."),(0,i.kt)("h3",{id:"create-named-credential"},"Create Named Credential"),(0,i.kt)("p",null,"See ",(0,i.kt)("a",{parentName:"p",href:"/docs/lightning/installation/01-installation#setting-up-the-executeawsservice-named-credential"},"here")," for instructions on setting up the Named Credential."),(0,i.kt)("h3",{id:"create-connected-app"},"Create Connected App"),(0,i.kt)("p",null,"To get access to the environment, a Connected App must be configured\nwith OAuth settings enabled."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Log in into your Salesforce org and go to ",(0,i.kt)("strong",{parentName:"p"},"Setup"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the ",(0,i.kt)("strong",{parentName:"p"},"Quick Find")," field, type ",(0,i.kt)("strong",{parentName:"p"},"app manager"),", then select ",(0,i.kt)("strong",{parentName:"p"},"App\nManager")," from the results")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the upper right corner, select ",(0,i.kt)("strong",{parentName:"p"},"New Connected App")))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image60.png")}),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},"On the New Connected App form, enter a name for the Connected App,\nsuch as ",(0,i.kt)("strong",{parentName:"li"},"Amazon Connect Integration")," and press tab. This will\npopulate the API Name automatically. Then provide a contact email\naddress")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image61.png")}),(0,i.kt)("ol",{start:5},(0,i.kt)("li",{parentName:"ol"},"Select the checkbox to ",(0,i.kt)("strong",{parentName:"li"},"Enable OAuth Settings"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image62.png")}),(0,i.kt)("ol",{start:6},(0,i.kt)("li",{parentName:"ol"},"Set the ",(0,i.kt)("strong",{parentName:"li"},"Callback URL")," to ",(0,i.kt)("a",{parentName:"li",href:"https://www.salesforce.com"},"https://www.salesforce.com"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image63.png")}),(0,i.kt)("ol",{start:7},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the Selected OAuth Scopes section, select the following and add\nthem to the Selected OAuth Scopes:")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Access and manage your data (api)")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Access your basic information (id, profile, email, address, phone)")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the checkbox for Require Secret for Web Server Flow")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"The ",(0,i.kt)("strong",{parentName:"p"},"API (Enable OAuth Settings)")," section should now look like\nthis"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image64.png")}),(0,i.kt)("ol",{start:12},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Save")," at the bottom of the screen.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Continue")," on the New Connected App page")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"You should now be at the new app's page")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Copy the value for ",(0,i.kt)("strong",{parentName:"p"},"Consumer Key")," to your notepad")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Click to reveal")," next to Consumer Secret and copy the\nvalue to your notepad")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"At the top of the detail page, select ",(0,i.kt)("strong",{parentName:"p"},"Manage"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the Connected App Detail page, select the ",(0,i.kt)("strong",{parentName:"p"},"Edit Policies"),"\nbutton")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Set Permitted Users to ",(0,i.kt)("strong",{parentName:"p"},"Admin approved users are pre-authorized"),"\nand choose OK on the pop-up dialog")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Set IP Relaxation to ",(0,i.kt)("strong",{parentName:"p"},"Relax IP restrictions"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"The OAuth Policies section should now look like the following"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image65.png")}),(0,i.kt)("ol",{start:22},(0,i.kt)("li",{parentName:"ol"},"Select ",(0,i.kt)("strong",{parentName:"li"},"Save"))),(0,i.kt)("h2",{id:"guided-setup-additional-instructions"},"Guided Setup Additional Instructions"),(0,i.kt)("p",null,"The below sections are linked to from the Guided Setup feature. Only perform the below steps when the\nGuided Setup feature links to them."),(0,i.kt)("h3",{id:"retrieve-amazon-connect-instance-url"},"Retrieve Amazon Connect Instance Url"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate to the ",(0,i.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/connect/home"},"Amazon Connect\nConsole"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select your Instance Alias")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the Overview page for your instance, copy the Login URL up until the ",(0,i.kt)("inlineCode",{parentName:"p"},"/")," (if your login url has one)."))),(0,i.kt)("img",{src:(0,o.Z)("/img/shared/guidedsetup4.png")}),(0,i.kt)("h3",{id:"add-users-to-the-call-center"},"Add users to the Call Center"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Log in into your Salesforce org and go to ",(0,i.kt)("strong",{parentName:"p"},"Setup"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the ",(0,i.kt)("strong",{parentName:"p"},"Quick Find")," field, enter ",(0,i.kt)("strong",{parentName:"p"},"Call Center"),", then select\n",(0,i.kt)("strong",{parentName:"p"},"Call Centers")," from the result list"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image28.png")}),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If you see the ",(0,i.kt)("strong",{parentName:"p"},"Say Hello to Salesforce Call Center")," page, select\n",(0,i.kt)("strong",{parentName:"p"},"Continue"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"AC Lightning Adapter")))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image29.png")}),(0,i.kt)("ol",{start:5},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the ",(0,i.kt)("strong",{parentName:"p"},"AC Lightning Adapter")," detail page, select ",(0,i.kt)("strong",{parentName:"p"},"Edit"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the ",(0,i.kt)("strong",{parentName:"p"},"AC Lightning Adapter: Manage Users")," page, select ",(0,i.kt)("strong",{parentName:"p"},"Add\nMore Users"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Set filters (if desired) and then choose ",(0,i.kt)("strong",{parentName:"p"},"Find"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the checkbox next to the user to add, then choose ",(0,i.kt)("strong",{parentName:"p"},"Add to\nCall Center"),"."))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image30.png")}),(0,i.kt)("ol",{start:9},(0,i.kt)("li",{parentName:"ol"},"Repeat the steps to add more users.")),(0,i.kt)("h3",{id:"add-users-to-a-permission-set"},"Add users to a Permission Set"),(0,i.kt)("p",null,"All users must be assigned the required permission set to access\nSalesforce metadata. The Amazon Connect CTI Adapter includes two\nPermission Sets, one for agents and one for managers, that grant users\nthe appropriate access for their role. More information on assigning\nuser permissions can be found in the ",(0,i.kt)("a",{parentName:"p",href:"https://help.salesforce.com/articleView?id=perm_sets_mass_assign.htm&type=5"},"Salesforce help\ndocumentation"),"."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Log in into your Salesforce org and go to ",(0,i.kt)("strong",{parentName:"p"},"Setup"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In ",(0,i.kt)("strong",{parentName:"p"},"Quick Find"),", enter ",(0,i.kt)("strong",{parentName:"p"},"Permission")," and select ",(0,i.kt)("strong",{parentName:"p"},"Permission\nSets")," from the results")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Choose ",(0,i.kt)("strong",{parentName:"p"},"AC_Administrator"),", ",(0,i.kt)("strong",{parentName:"p"},"AC_Agent")," or ",(0,i.kt)("strong",{parentName:"p"},"AC_Manager")," as\nappropriate for the user(s)"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image12.png")}),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Choose ",(0,i.kt)("strong",{parentName:"p"},"Manage Assignments"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Choose ",(0,i.kt)("strong",{parentName:"p"},"Add Assignments"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the users to assign the permissions, then choose ",(0,i.kt)("strong",{parentName:"p"},"Assign"),"."))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image13.png")}),(0,i.kt)("ol",{start:7},(0,i.kt)("li",{parentName:"ol"},"Repeat these steps as needed for all users")),(0,i.kt)("h4",{id:"ac_administrator"},"AC_Administrator"),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image14.png")}),(0,i.kt)("h4",{id:"ac_manager"},"AC_Manager"),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image15.png")}),(0,i.kt)("h4",{id:"ac_agent"},"AC_Agent"),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image16.png")}),(0,i.kt)("h3",{id:"configure-the-toolkit-settings"},"Configure the Toolkit settings"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Navigate to ",(0,i.kt)("strong",{parentName:"li"},"Setup")," then in type ",(0,i.kt)("strong",{parentName:"li"},"Custom Settings")," in Quick\nFind")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image31.png")}),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"Next to the Toolkit for Amazon Connect custom setting, choose\n",(0,i.kt)("strong",{parentName:"li"},"Manage"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image32.png")}),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},"Select ",(0,i.kt)("strong",{parentName:"li"},"New"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image33.png")}),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},"On the following page, provide the URL to your Amazon Connect\ninstance. This value can be found in your Amazon Connect console.")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/amazonconnectconsoleaccessurl.png")}),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image34.png")}),(0,i.kt)("p",null,"You will also see the option to enable and disable certain\ntriggers in the package, which you can configure to meet your needs. You\ncan change these whenever you would like to. For more details, see the troubleshooting section. "),(0,i.kt)("ol",{start:5},(0,i.kt)("li",{parentName:"ol"},"Select ",(0,i.kt)("strong",{parentName:"li"},"Save"))),(0,i.kt)("h3",{id:"create-the-softphone-layout"},"Create the Softphone Layout"),(0,i.kt)("p",null,"The softphone layout settings will tell the console what resources are\navailable for screenpop by default and what to do under different match\nconditions."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Log in into your Salesforce org and go to ",(0,i.kt)("strong",{parentName:"p"},"Setup"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the ",(0,i.kt)("strong",{parentName:"p"},"Quick Find")," box, type ",(0,i.kt)("strong",{parentName:"p"},"Softphone"),", then choose\n",(0,i.kt)("strong",{parentName:"p"},"Softphone Layouts")," from the results")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If you are presented with the Get Started message, choose\n",(0,i.kt)("strong",{parentName:"p"},"Continue"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the Softphone Layouts page, choose ",(0,i.kt)("strong",{parentName:"p"},"New")))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image35.png")}),(0,i.kt)("ol",{start:5},(0,i.kt)("li",{parentName:"ol"},"Enter a name for the layout, such as ",(0,i.kt)("strong",{parentName:"li"},"AmazonConnectDefault"),", then\nselect the ",(0,i.kt)("strong",{parentName:"li"},"Is Default Layout")," checkbox.")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image36.png")}),(0,i.kt)("ol",{start:6},(0,i.kt)("li",{parentName:"ol"},"Expand ",(0,i.kt)("strong",{parentName:"li"},"Display these salesforce.com objects")," and select objects\nthat CTI Connector should be able to search, for a screen-pop query.\nIn this example, Case has been added to the default selection,\nallowing search and screen-pop by CaseID.")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image37.png")}),(0,i.kt)("ol",{start:7},(0,i.kt)("li",{parentName:"ol"},"If desired, configure the search behavior to your requirements")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image38.png")}),(0,i.kt)("ol",{start:8},(0,i.kt)("li",{parentName:"ol"},"Additionally, validate the Screen Pop settings. Please note that the\ndefault behavior is to not pop a screen if there is more than one\nresult")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image39.png")}),(0,i.kt)("ol",{start:9},(0,i.kt)("li",{parentName:"ol"},"Once you have configured the search behavior, choose ",(0,i.kt)("strong",{parentName:"li"},"Save"))),(0,i.kt)("h3",{id:"retrieve-the-salesforce-api-version"},"Retrieve the Salesforce API Version"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Log in into your Salesforce org and go to ",(0,i.kt)("strong",{parentName:"p"},"Setup"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the ",(0,i.kt)("strong",{parentName:"p"},"Quick Find")," field, type ",(0,i.kt)("strong",{parentName:"p"},"apex"),", then select ",(0,i.kt)("strong",{parentName:"p"},"Apex\nClasses")," from the results"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image56.png")}),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},"Select New")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image57.png")}),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},"Select the Version Settings tab")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image58.png")}),(0,i.kt)("ol",{start:5},(0,i.kt)("li",{parentName:"ol"},"Note the Salesforce.com API version in your notepad")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image59.png")}),(0,i.kt)("h3",{id:"setting-up-the-salesforce-api-user"},"Setting up the Salesforce API User"),(0,i.kt)("p",null,"The Lambda functions authenticate with Salesforce via user credentials.\nIt is a common practice to create an API user account for this purpose."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Log in into your Salesforce org and go to ",(0,i.kt)("strong",{parentName:"p"},"Setup"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the ",(0,i.kt)("strong",{parentName:"p"},"Quick Find")," field, type ",(0,i.kt)("strong",{parentName:"p"},"profiles"),", then select\n",(0,i.kt)("strong",{parentName:"p"},"Profiles")," from the results")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select New Profile"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image66.png")}),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Provide a Profile Name, such as ",(0,i.kt)("strong",{parentName:"p"},"API_ONLY"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"From the ",(0,i.kt)("strong",{parentName:"p"},"Existing Profile")," dropdown, select ",(0,i.kt)("strong",{parentName:"p"},"System Administrator"),"\n",(0,i.kt)("strong",{parentName:"p"},"NOTE:")," You\\'re advised to use a full Salesforce License for the\nuser to be able to set the below permissions and have full access to\navoid any other errors."))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image67.png")}),(0,i.kt)("ol",{start:6},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Save")," to create the new profile")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Once the new profile page opens, select the ",(0,i.kt)("strong",{parentName:"p"},"Edit")," button")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Scroll down to the Administrative Permissions section")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If the Lightning Experience User checkbox is selected, clear it"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image68.png")}),(0,i.kt)("ol",{start:10},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Scroll down to the ",(0,i.kt)("strong",{parentName:"p"},"Password Policies")," section at the bottom of\nthe page")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Set ",(0,i.kt)("strong",{parentName:"p"},"User password expire in")," to ",(0,i.kt)("strong",{parentName:"p"},"Never expires"),"\n",(0,i.kt)("strong",{parentName:"p"},"NOTE:")," Failure to this may lead to production outages.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Save"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the ",(0,i.kt)("strong",{parentName:"p"},"Quick Find")," field, type ",(0,i.kt)("strong",{parentName:"p"},"connect"),", then select ",(0,i.kt)("strong",{parentName:"p"},"Manage\nConnected Apps")," from the results"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image69.png")}),(0,i.kt)("ol",{start:14},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the app you have created earlier, ",(0,i.kt)("strong",{parentName:"p"},"Amazon Connect\nIntegration"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the profiles section, select ",(0,i.kt)("strong",{parentName:"p"},"Manage Profiles"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the new ",(0,i.kt)("strong",{parentName:"p"},"API_Only")," profile that you just created")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Save")," at the bottom of the page")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the ",(0,i.kt)("strong",{parentName:"p"},"Quick Find")," field, type ",(0,i.kt)("strong",{parentName:"p"},"users")," then select ",(0,i.kt)("strong",{parentName:"p"},"Users"),"\nfrom the results")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select New User")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Set the required fields as:"),(0,i.kt)("p",{parentName:"li"},"a.  Last Name: apiuser"),(0,i.kt)("p",{parentName:"li"},"b.  Alias: apiuser"),(0,i.kt)("p",{parentName:"li"},"c.  Email: provide a valid email address"),(0,i.kt)("p",{parentName:"li"},"d.  Username: apiuser@<yoursalesforcedomain",">",".com"),(0,i.kt)("p",{parentName:"li"},"e.  Nickname: apiuser")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the right-hand side, set ",(0,i.kt)("strong",{parentName:"p"},"User License")," to ",(0,i.kt)("strong",{parentName:"p"},"Salesforce"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Set Profile to API_ONLY")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Choose ",(0,i.kt)("strong",{parentName:"p"},"Save"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In ",(0,i.kt)("strong",{parentName:"p"},"Quick Find"),', search for "Permission Sets". Select the ',(0,i.kt)("strong",{parentName:"p"},"AC_Administrator")," permission set."))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/lambda-install-0.png")}),(0,i.kt)("ol",{start:25},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Manage Assignments"),". Add the apiuser you just created to the permission set.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"A confirmation email with an ",(0,i.kt)("strong",{parentName:"p"},"activation link")," will be sent to the\nemail address provided. Choose the link to activate your user and\nset their password")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Fill out the form to set a password for the API user")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Change Password"),". The API user will log into the\nSalesforce Classic view")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Access the API user's personal settings by selecting the username in\nthe top right corner, then choose ",(0,i.kt)("strong",{parentName:"p"},"My Settings")))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image70.png")}),(0,i.kt)("ol",{start:30},(0,i.kt)("li",{parentName:"ol"},"In the ",(0,i.kt)("strong",{parentName:"li"},"Quick Find")," field, type ",(0,i.kt)("strong",{parentName:"li"},"security")," then select ",(0,i.kt)("strong",{parentName:"li"},"Reset\nMy Security Token")," from the results")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image71.png")}),(0,i.kt)("ol",{start:31},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Reset Security Token"),". Your security token will be emailed\nto you")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Copy the security token from the email to your notepad"))),(0,i.kt)("h3",{id:"setting-up-the-secretsmanager-secret"},"Setting up the SecretsManager Secret"),(0,i.kt)("p",null,"To ensure that your Salesforce credentials are secure, the Lambdas\nrequire that the credentials are stored in AWS Secrets Manager. AWS\nSecrets Manager is a highly secure service that helps you store and\nretrieve secrets."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In a new browser tab, login to the AWS console")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Make sure you are in the same region as your Amazon Connect\ninstance. You can set the region by expanding the region selector in\nthe upper right and choosing the region"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image75.png")}),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate to the ",(0,i.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/secretsmanager/home"},"Secrets Manager\nconsole"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Secrets"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Store a new secret"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Other types of secrets"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Make sure ",(0,i.kt)("strong",{parentName:"p"},"Secret key/value")," is selected")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Enter key value pairs that match the following:"),(0,i.kt)("p",{parentName:"li"},"a.  ",(0,i.kt)("strong",{parentName:"p"},"Key:")," Password, ",(0,i.kt)("strong",{parentName:"p"},"Value:")," the password for the API user that\nyou configured in the previous section"),(0,i.kt)("p",{parentName:"li"},"b.  ",(0,i.kt)("strong",{parentName:"p"},"Key:")," ConsumerKey, ",(0,i.kt)("strong",{parentName:"p"},"Value:")," the Consumer Key for the\nConnected App you created in the previous section"),(0,i.kt)("p",{parentName:"li"},"c.  ",(0,i.kt)("strong",{parentName:"p"},"Key:")," ConsumerSecret, ",(0,i.kt)("strong",{parentName:"p"},"Value:")," the Consumer Secret for the\nConnected App you created in the previous section"),(0,i.kt)("p",{parentName:"li"},"d.  ",(0,i.kt)("strong",{parentName:"p"},"Key:")," AccessToken, ",(0,i.kt)("strong",{parentName:"p"},"Value:")," this is the access token for\nthe API user that you configured in the previous section")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"For the encryption key, click ",(0,i.kt)("strong",{parentName:"p"},"Add new key"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Create Key"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Make sure key type is set to ",(0,i.kt)("strong",{parentName:"p"},"symmetric"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Give your key an ",(0,i.kt)("strong",{parentName:"p"},"alias"),", like\n",(0,i.kt)("em",{parentName:"p"},"SalesforceCredentialsSecretsManagerKey"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Next")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select administrators you want to have access permission to change\nthe key policy. Make sure you are being as restrictive as possible")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Next")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the users and roles you want to have access to the Salesforce\ncredentials in Secrets Manager. Make sure you are being as\nrestrictive as possible")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Next")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Finish")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click on the managed key that you just created (which is\n",(0,i.kt)("em",{parentName:"p"},"SalesforceCredentialsSecretsManagerKey")," in this case).")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Note down the ARN. This is SalesforceCredentialsKMSKeyARN that will\nbe used later when installing the Amazon Connect Salesforce Lambda\npackage.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate back to the Secrets Manager setup tab")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the key you just created"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image76.png")}),(0,i.kt)("ol",{start:23},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Next")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Give your secret a name, like ",(0,i.kt)("em",{parentName:"p"},"SalesforceCredentials"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Next")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Make sure ",(0,i.kt)("strong",{parentName:"p"},"Disable automatic rotation")," is checked.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Next")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Store")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the secret you just created, and copy the Secret ARN"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image77.png")}),(0,i.kt)("h3",{id:"test-the-salesforce-lambda-core-functionality"},"Test the Salesforce Lambda Core Functionality"),(0,i.kt)("p",null,"The package provides a core Lambda function (sfInvokeAPI) that supports\nmultiple operations, like lookup, create and update. For the initial\nvalidation, sample events are provided within the function. Validating\nthis function provides a good check that the installation and\nconfiguration is correct."),(0,i.kt)("p",null,"Validating the lambda functions requires the use of test events to\nsimulate data coming into the function as it would in a typical\ndeployment. Each function has a set of test event samples included to\nmake validation easier."),(0,i.kt)("h4",{id:"validate-the-core-functionality"},"Validate the core functionality"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In a new browser tab, login to the ",(0,i.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/"},(0,i.kt)("strong",{parentName:"a"},"AWS\nconsole")))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Open the ",(0,i.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/lambda/home"},"AWS Lambda\nConsole"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the Filter field, enter sfInvokeAPI and press enter, this will\nfilter your list out to the core function that we just installed"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image82.png")}),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the ",(0,i.kt)("strong",{parentName:"p"},"function name.")," First, we will validate a phone number\nlookup.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the Environment pane, double-click the event-phoneLookup.json\nfile"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image83.png")}),(0,i.kt)("ol",{start:6},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"The test even JSON will open in the Lambda editor")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Modify the value for sf_phone to match the phone number of the test\ncontact you created when you setup the CTI adapter or for any valid\ncontact in your Salesforce org\\\nNOTE: The phone number must be in ",(0,i.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/connect/latest/adminguide/amazon-connect-contact-control-panel.html#international-calls-ccp"},"E.164\nformat")))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image84.png")}),(0,i.kt)("ol",{start:8},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the entire JSON event and copy it, then close the\n",(0,i.kt)("strong",{parentName:"p"},"event-phoneLookup.json")," tab.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the top-right corner, select drop-down arrow next to ",(0,i.kt)("strong",{parentName:"p"},"Test")," and\nchoose ",(0,i.kt)("strong",{parentName:"p"},"Configure test events")))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image85.png")}),(0,i.kt)("ol",{start:10},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the radio button for ",(0,i.kt)("strong",{parentName:"p"},"Create new test event")," and provide an\nevent name, for example: ",(0,i.kt)("strong",{parentName:"p"},"phoneLookup"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the existing event JSON and ",(0,i.kt)("strong",{parentName:"p"},"delete")," it. Paste the modified\nJSON payload you copied from the ",(0,i.kt)("strong",{parentName:"p"},"event-phoneLookup.json")," file"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image86.png")}),(0,i.kt)("ol",{start:12},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Create")," to save your test event")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"By default, your new test event should be selected in the drop-down\nlist to the left of the Test button."))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image87.png")}),(0,i.kt)("ol",{start:14},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Test"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'If successful, the result will contain fields defined in "sf_fields"\nparameter in the invocation event'))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image88.png")}),(0,i.kt)("ol",{start:16},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Copy the value for the ",(0,i.kt)("strong",{parentName:"p"},"Id")," key in the response. Next, we are\ngoing to use that Id to create a Case in Salesforce.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the Environment pane, double-click the ",(0,i.kt)("strong",{parentName:"p"},"event-create.json"),"\nfile. Replace the existing ContactId value with the ID value you\ncopied previously."))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image89.png")}),(0,i.kt)("ol",{start:18},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the entire JSON event and copy it, then close the\n",(0,i.kt)("strong",{parentName:"p"},"event-create.json")," tab.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the top-right corner, select drop-down arrow next to ",(0,i.kt)("strong",{parentName:"p"},"Test")," and\nchoose ",(0,i.kt)("strong",{parentName:"p"},"Configure test events")))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image90.png")}),(0,i.kt)("ol",{start:20},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the radio button for ",(0,i.kt)("strong",{parentName:"p"},"Create new test event")," and provide an\nevent name, for example: ",(0,i.kt)("strong",{parentName:"p"},"createCase"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the existing event JSON and ",(0,i.kt)("strong",{parentName:"p"},"delete")," it. Paste the modified\nJSON payload you copied from the ",(0,i.kt)("strong",{parentName:"p"},"event-create.json")," file"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image91.png")}),(0,i.kt)("ol",{start:22},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Create")," to save your test event")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"By default, your new test event should be selected in the drop-down\nlist to the left of the Test button."))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image92.png")}),(0,i.kt)("ol",{start:24},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Test"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If successful, the result will contain the Case Id"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image93.png")}),(0,i.kt)("ol",{start:26},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Copy the value for the ",(0,i.kt)("strong",{parentName:"p"},"Id")," key in the response.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"When we created the case, the ",(0,i.kt)("strong",{parentName:"p"},"Status was set to New")," and the\n",(0,i.kt)("strong",{parentName:"p"},"Priority to Low"),". We are going to use the update operation to\nclose the case.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the Environment pane, double-click the ",(0,i.kt)("strong",{parentName:"p"},"event-update.json"),' file\nand replace the existing Case Id in "sf_id" parameter with the new\none you copied from the last test result'))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image94.png")}),(0,i.kt)("ol",{start:29},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the ",(0,i.kt)("strong",{parentName:"p"},"entire JSON event")," and copy it, then close the\n",(0,i.kt)("strong",{parentName:"p"},"event-update.json")," tab.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the top-right corner, select drop-down arrow next to ",(0,i.kt)("strong",{parentName:"p"},"Test")," and\nchoose **Configure test events"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image95.png")}),(0,i.kt)("ol",{start:31},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the radio button for ",(0,i.kt)("strong",{parentName:"p"},"Create new test event")," and provide an\nevent name, for example: ",(0,i.kt)("strong",{parentName:"p"},"updateCase"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the existing event JSON and ",(0,i.kt)("strong",{parentName:"p"},"delete")," it. Paste the modified\nJSON payload you copied from the ",(0,i.kt)("strong",{parentName:"p"},"event-update.json")," file"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image96.png")}),(0,i.kt)("ol",{start:33},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Create")," to save your test event")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"By default, your new test event should be selected in the drop-down\nlist to the left of the Test button."))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image97.png")}),(0,i.kt)("ol",{start:35},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Test"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If successful, the result will be the ",(0,i.kt)("strong",{parentName:"p"},"HTTP 204")," No Content\nsuccess status response code"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image98.png")}),(0,i.kt)("ol",{start:37},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Log in into your Salesforce org and go to the ",(0,i.kt)("strong",{parentName:"p"},"Service Console"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the search box, change the object type to Cases and type Amazon\nConnect Case, then press enter"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image99.png")}),(0,i.kt)("ol",{start:39},(0,i.kt)("li",{parentName:"ol"},"You should find 1 case opened by the API user, and the status should\nbe closed")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image100.png")}),(0,i.kt)("ol",{start:40},(0,i.kt)("li",{parentName:"ol"},"You have completed core function validation")),(0,i.kt)("h3",{id:"allow-amazon-connect-to-access-the-sfinvokeapi-lambda-function"},"Allow Amazon Connect to Access the sfInvokeAPI Lambda Function"),(0,i.kt)("p",null,"Once you have validated function, you can use the Amazon Connect console\nto add the sfInvokeAPI Lambda function to your Amazon Connect instance.\nThis automatically adds resource permissions that allow Amazon Connect\nto invoke the function."),(0,i.kt)("h4",{id:"add-the-lambda-function-to-your-amazon-connect-instance"},"Add the Lambda function to your Amazon Connect instance"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In a new browser tab, login to the ",(0,i.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/"},(0,i.kt)("strong",{parentName:"a"},"AWS\nconsole")))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate to the ",(0,i.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/connect/home"},"Amazon Connect\nConsole"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select your ",(0,i.kt)("strong",{parentName:"p"},"Instance Alias"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the navigation pane, choose ",(0,i.kt)("strong",{parentName:"p"},"Contact flows"),"."))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image101.png")}),(0,i.kt)("ol",{start:5},(0,i.kt)("li",{parentName:"ol"},"For ",(0,i.kt)("strong",{parentName:"li"},"AWS Lambda"),", select the function that includes sfInvokeAPI in\nthe name")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image102.png")}),(0,i.kt)("ol",{start:6},(0,i.kt)("li",{parentName:"ol"},"Choose ",(0,i.kt)("strong",{parentName:"li"},"Add Lambda Function"),". Confirm that the ARN of the function\nis added under ",(0,i.kt)("strong",{parentName:"li"},"Lambda Functions"),".")),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image103.png")}),(0,i.kt)("ol",{start:7},(0,i.kt)("li",{parentName:"ol"},"The AWS Lambda function has been added to your Amazon Connect\ninstance.")),(0,i.kt)("h3",{id:"create-publicprivate-key-pair-for-the-cloudfront-distribution"},"Create Public/Private key pair for the Cloudfront distribution"),(0,i.kt)("p",null,"Use the following command to generate a private key:"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"openssl genrsa -out private_key.pem 2048")),(0,i.kt)("p",null,"Use the following command to generate a public key from the private key:\n",(0,i.kt)("inlineCode",{parentName:"p"},"openssl rsa -pubout -in private_key.pem -out public_key.pem")),(0,i.kt)("h3",{id:"add-private-key-access-key-to-secrets-manager-secret"},"Add Private Key, Access Key to Secrets Manager Secret"),(0,i.kt)("p",null,"To retrieve the Access Key ID:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate to the Cloudfront console.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the left hand sidebar, select ",(0,i.kt)("strong",{parentName:"p"},"Public keys"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Look for the public key that was created by Guided Setup, and copy down the public key's ID"))),(0,i.kt)("img",{src:(0,o.Z)("/img/shared/guidedsetup5.png")}),(0,i.kt)("p",null,"To add the private key and access key to the Secrets Manager secret:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},'Copy and paste the contents of the private key .pem file into a text editor. Replace every newline character with a space, and then delete the last character. This is most easily done using a "find and replace" feature in your text editor.\nThe resulting string of text should resemble the following:')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"-----BEGIN RSA PRIVATE KEY----- (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (64 character string) (under 64 character string) -----END RSA PRIVATE KEY-----\n")),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Navigate to the "Secrets Manager" service. Select the ',(0,i.kt)("strong",{parentName:"p"},"SalesforceCredentials"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Under the "Secret value" tab, select "Retrieve secret value" and then "Edit".')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"For the ",(0,i.kt)("strong",{parentName:"p"},"CloudFrontPrivateKey")," field, copy and paste the modified contents of the private key .pem file. For the ",(0,i.kt)("strong",{parentName:"p"},"CloudFrontAccessKeyID")," field, copy and paste the ",(0,i.kt)("strong",{parentName:"p"},"Access Key Id")," you recorded above. Your Secrets Manager Secret should look like the following:"))),(0,i.kt)("img",{src:(0,o.Z)("/img/lightning/image270.png")}),(0,i.kt)("p",null,'Please note that your secret may also be formatted stored as a "Secret key/value" secret rather than a "Plaintext" secret; both secret types are valid.'))}k.isMDXComponent=!0}}]);