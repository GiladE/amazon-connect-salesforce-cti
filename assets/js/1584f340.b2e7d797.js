"use strict";(self.webpackChunkamazon_connect_salesforce_cti=self.webpackChunkamazon_connect_salesforce_cti||[]).push([[3039],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return u}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},k=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),k=c(a),u=r,g=k["".concat(l,".").concat(u)]||k[u]||m[u]||i;return a?n.createElement(g,o(o({ref:t},p),{},{components:a})):n.createElement(g,o({ref:t},p))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=k;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var c=2;c<i;c++)o[c]=a[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}k.displayName="MDXCreateElement"},3919:function(e,t,a){function n(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!n(e)}a.d(t,{b:function(){return n},Z:function(){return r}})},4996:function(e,t,a){a.d(t,{C:function(){return i},Z:function(){return o}});var n=a(2263),r=a(3919);function i(){var e=(0,n.Z)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,a=void 0===t?"/":t,i=e.url;return{withBaseUrl:function(e,t){return function(e,t,a,n){var i=void 0===n?{}:n,o=i.forcePrependBaseUrl,s=void 0!==o&&o,l=i.absolute,c=void 0!==l&&l;if(!a)return a;if(a.startsWith("#"))return a;if((0,r.b)(a))return a;if(s)return t+a;var p=a.startsWith(t)?a:t+a.replace(/^\//,"");return c?e+p:p}(i,a,e,t)}}}function o(e,t){return void 0===t&&(t={}),(0,i().withBaseUrl)(e,t)}},8171:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return l},contentTitle:function(){return c},metadata:function(){return p},toc:function(){return m},default:function(){return u}});var n=a(7462),r=a(3366),i=(a(7294),a(3905)),o=a(4996),s=["components"],l={id:"04-salesforce-lambdas-manual-setup",title:"Setting Up The Salesforce Lambdas Manually"},c=void 0,p={unversionedId:"classic/installation/04-salesforce-lambdas-manual-setup",id:"classic/installation/04-salesforce-lambdas-manual-setup",isDocsHomePage:!1,title:"Setting Up The Salesforce Lambdas Manually",description:"Below are manual setup instructions for the Salesforce Lambdas.",source:"@site/docs/classic/02-installation/04-salesforce-lambdas-manual-setup.md",sourceDirName:"classic/02-installation",slug:"/classic/installation/04-salesforce-lambdas-manual-setup",permalink:"/amazon-connect-salesforce-cti/docs/classic/installation/04-salesforce-lambdas-manual-setup",editUrl:"https://github.com/amazon-connect/amazon-connect-salesforce-cti/docs/classic/02-installation/04-salesforce-lambdas-manual-setup.md",version:"current",sidebarPosition:4,frontMatter:{id:"04-salesforce-lambdas-manual-setup",title:"Setting Up The Salesforce Lambdas Manually"},sidebar:"classic",previous:{title:"Setting Up The CTI Adapter Managed Package Manually",permalink:"/amazon-connect-salesforce-cti/docs/classic/installation/03-managed-package-manual-setup"},next:{title:"Upgrading from an Earlier Version",permalink:"/amazon-connect-salesforce-cti/docs/classic/installation/05-upgrading-from-an-earlier-version"}},m=[{value:"Salesforce Lambda Prerequisites",id:"salesforce-lambda-prerequisites",children:[{value:"Determine your production Environment",id:"determine-your-production-environment",children:[]},{value:"Determine your Consumer Key and Secret",id:"determine-your-consumer-key-and-secret",children:[]},{value:"Determine your Username, Password and Security Token",id:"determine-your-username-password-and-security-token",children:[]},{value:"Store Salesforce credentials in AWS Secrets Manager",id:"store-salesforce-credentials-in-aws-secrets-manager",children:[]}]},{value:"Install the Amazon Connect Salesforce Lambda package",id:"install-the-amazon-connect-salesforce-lambda-package",children:[]}],k={toc:m};function u(e){var t=e.components,a=(0,r.Z)(e,s);return(0,i.kt)("wrapper",(0,n.Z)({},k,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Below are manual setup instructions for the Salesforce Lambdas."),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image100.png")}),(0,i.kt)("h2",{id:"salesforce-lambda-prerequisites"},"Salesforce Lambda Prerequisites"),(0,i.kt)("p",null,"Consider the following prerequisites before you install the Lambda\npackage."),(0,i.kt)("h3",{id:"determine-your-production-environment"},"Determine your production Environment"),(0,i.kt)("p",null,'In your installation notes, enter the value for "Production Environment"\nas "true" or "false", depending on whether the Salesforce environment\nthat you are deploying the package into is a production or a sandbox.\nFor Production, enter "true". For Sandbox enter "false".'),(0,i.kt)("h3",{id:"determine-your-consumer-key-and-secret"},"Determine your Consumer Key and Secret"),(0,i.kt)("p",null,"To leverage the full potential of the integration, Salesforce data needs\nto be accessed from AWS environment. The AWS Serverless package comes\nwith a set of pre-built queries to lookup, update and create Salesforce\nobjects within Amazon Connect Contact Flows, in form of AWS Lambda\nfunctions."),(0,i.kt)("p",null,"The Lambda function access Salesforce using the Salesforce REST API. To\nget access to the environment, a Connected App must be configured with\nOAuth settings enabled."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Log in to Salesforce")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate to Setup ",">"," Create ",">"," Apps"))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image101.png")}),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Click on the "New" button for the Connected Apps at the bottom of the page')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'In the following form, fill out the Connected App Name, API Name and Contact Email with values of your choice. We recommend "Amazon Connect Integration" as the Connected App Name and the default value for the API name.'))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image102.png")}),(0,i.kt)("ol",{start:5},(0,i.kt)("li",{parentName:"ol"},'Select the checkbox next to "Enable OAuth Settings" as shown below.')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image103.png")}),(0,i.kt)("ol",{start:6},(0,i.kt)("li",{parentName:"ol"},"Ensure the Callback URL is set to ",(0,i.kt)("a",{parentName:"li",href:"https://www.salesforce.com"},"https://www.salesforce.com"))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image104.png")}),(0,i.kt)("ol",{start:7},(0,i.kt)("li",{parentName:"ol"},"Ensure Selected OAuth Scopes has the following values selected:")),(0,i.kt)("p",null,"a.  Access the identity URL service (id, profile, email, address, phone)"),(0,i.kt)("p",null,"b.  Manage user data via APIs (api)"),(0,i.kt)("ol",{start:8},(0,i.kt)("li",{parentName:"ol"},'Select the checkbox "Require Secret for Web Server Flow", and the checkbox "Require Secret For Refresh Token Flow"')),(0,i.kt)("img",{src:(0,o.Z)("/img/shared/guidedsetup4.png")}),(0,i.kt)("ol",{start:9},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Click "Save" at the bottom of the screen.')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Click "Continue" on the next screen'))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image107.png")}),(0,i.kt)("ol",{start:11},(0,i.kt)("li",{parentName:"ol"},'Once the app has been created, on the app\'s detail screen, please copy the "Consumer Key" value to your installation notes')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image108.png")}),(0,i.kt)("ol",{start:12},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Select "Click to reveal" next to Consumer Secret and record this value to "Consumer Secret" in your installation notes.')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Click "Manage" at the top of the page'))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image109.png")}),(0,i.kt)("ol",{start:14},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'On the page that appears, click "Edit Policies"')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Set "Permitted Users" to "Admin approved users are pre-authorizes"'))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image110.png")}),(0,i.kt)("ol",{start:16},(0,i.kt)("li",{parentName:"ol"},'Click "OK" on the pop-up dialog:')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image111.png")}),(0,i.kt)("ol",{start:17},(0,i.kt)("li",{parentName:"ol"},'Set "IP Relaxation" to "Relax IP restrictions"')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image112.png")}),(0,i.kt)("ol",{start:18},(0,i.kt)("li",{parentName:"ol"},'Click "Save"')),(0,i.kt)("h3",{id:"determine-your-username-password-and-security-token"},"Determine your Username, Password and Security Token"),(0,i.kt)("p",null,"The authentication of the Lambda Functions requires valid user\ncredentials. It is a common practice to create an API user account for\nthis purpose."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Log in to Salesforce")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate to Setup ",">"," Manage Users ",">"," Profiles")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Click "New Profile"')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Enter the Profile Name (i.e. "API Only")')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the existing profile to clone (The integration user\\'s access to just those objects required for the integration)"))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image113.png")}),(0,i.kt)("p",null,"NOTE: You\\'re advised to use a full Salesforce License for the user to\nbe able to set the below permissions and have full access to avoid any\nother errors."),(0,i.kt)("ol",{start:6},(0,i.kt)("li",{parentName:"ol"},'Click "Save". A New Profile is created:')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image114.png")}),(0,i.kt)("ol",{start:7},(0,i.kt)("li",{parentName:"ol"},"Once the new profile page opens, select the ",(0,i.kt)("strong",{parentName:"li"},"System Permissions")," button")),(0,i.kt)("img",{src:(0,o.Z)("/img/shared/usersetup1.png")}),(0,i.kt)("ol",{start:8},(0,i.kt)("li",{parentName:"ol"},"If the Lightning Experience User checkbox is selected, clear it")),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image117.png")}),(0,i.kt)("ol",{start:9},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Save the system permissions, then go back to Profile Overview")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the ",(0,i.kt)("em",{parentName:"p"},"Password Policies")," link, click edit"))),(0,i.kt)("img",{src:(0,o.Z)("/img/shared/usersetup2.png")}),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image115.png")}),(0,i.kt)("ol",{start:11},(0,i.kt)("li",{parentName:"ol"},"Set ",(0,i.kt)("strong",{parentName:"li"},"User password expire in")," to ",(0,i.kt)("strong",{parentName:"li"},"Never expires")," ",(0,i.kt)("strong",{parentName:"li"},"NOTE:")," Failure to this may lead to production outages.")),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image116.png")}),(0,i.kt)("ol",{start:12},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Save"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate to Setup ",">"," Manage Apps ",">"," Connected Apps")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the app you have created in the previous step (i.e. Amazon Connect Integration)"))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image118.png")}),(0,i.kt)("ol",{start:15},(0,i.kt)("li",{parentName:"ol"},'Click "Manage Profiles"')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image119.png")}),(0,i.kt)("ol",{start:16},(0,i.kt)("li",{parentName:"ol"},'Ensure the "API Only" profile is selected:')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image120.png")}),(0,i.kt)("ol",{start:17},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Click "Save" at the bottom of the page')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate to Setup ",">"," Manage Users ",">"," Users")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Click "New User"'))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image121.png")}),(0,i.kt)("ol",{start:20},(0,i.kt)("li",{parentName:"ol"},"Set necessary fields: Last Name, Alias, Email, Username, Nickname")),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image122.png")}),(0,i.kt)("ol",{start:21},(0,i.kt)("li",{parentName:"ol"},"On the right-hand side, set the User License and Profile")),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image123.png")}),(0,i.kt)("ol",{start:22},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Click "Save"')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In ",(0,i.kt)("strong",{parentName:"p"},"Quick Find"),', search for "Permission Sets". Select the ',(0,i.kt)("strong",{parentName:"p"},"AC_Administrator")," permission set."))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/lambda-install-0.png")}),(0,i.kt)("ol",{start:24},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Manage Assignments"),". Add the apiuser you just created to the permission set.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"A confirmation email will be sent, with an activation link. Click the link to activate your user."))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image124.png")}),(0,i.kt)("p",null,"Change (set) a password for apiuser (Considered a strong that contains\nat least 20 random characters):"),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image125.png")}),(0,i.kt)("ol",{start:26},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Click "Change Password"')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Access the apiuser personal settings by selecting the username in the top right corner, then "My Settings".'))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image126.png")}),(0,i.kt)("ol",{start:28},(0,i.kt)("li",{parentName:"ol"},'Type "Security Token" in the Quick Find box and click "Reset My Security Token".')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image127.png")}),(0,i.kt)("ol",{start:29},(0,i.kt)("li",{parentName:"ol"},"Your security token will be emailed to you")),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image128.png")}),(0,i.kt)("ol",{start:30},(0,i.kt)("li",{parentName:"ol"},'Copy the security token from the email in to your installation notes for the "Access Token" value.')),(0,i.kt)("h3",{id:"store-salesforce-credentials-in-aws-secrets-manager"},"Store Salesforce credentials in AWS Secrets Manager"),(0,i.kt)("p",null,"To ensure that your Salesforce credentials are secure, the Lambdas\nrequire that the credentials are stored in AWS Secrets Manager. AWS\nSecrets Manager is a highly secure service that helps you store and\nretrieve secrets."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In a new browser tab, login to the AWS console")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Make sure you are in the same region as your Amazon Connect\ninstance. You can set the region by expanding the region selector in\nthe upper right and choosing the region"))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image129.png")}),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate to the ",(0,i.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/secretsmanager/home"},"Secrets Manager\nconsole"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Secrets"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Store a new secret"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Other types of secrets"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Make sure ",(0,i.kt)("strong",{parentName:"p"},"Secret key/value")," is selected")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Enter key value pairs that match the following:"),(0,i.kt)("p",{parentName:"li"},"a.  ",(0,i.kt)("strong",{parentName:"p"},"Key:")," Password, ",(0,i.kt)("strong",{parentName:"p"},"Value:")," the password for the API user that\nyou configured in the previous section"),(0,i.kt)("p",{parentName:"li"},"b.  ",(0,i.kt)("strong",{parentName:"p"},"Key:")," ConsumerKey, ",(0,i.kt)("strong",{parentName:"p"},"Value:")," the Consumer Key for the\nConnected App you created in the previous section"),(0,i.kt)("p",{parentName:"li"},"c.  ",(0,i.kt)("strong",{parentName:"p"},"Key:")," ConsumerSecret, ",(0,i.kt)("strong",{parentName:"p"},"Value:")," the Consumer Secret for the\nConnected App you created in the previous section"),(0,i.kt)("p",{parentName:"li"},"d.  ",(0,i.kt)("strong",{parentName:"p"},"Key:")," AccessToken, ",(0,i.kt)("strong",{parentName:"p"},"Value:")," this is the access token for\nthe API user that you configured in the previous section")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'For the encryption key, click "Add new key"')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Create Key"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Make sure key type is set to ",(0,i.kt)("strong",{parentName:"p"},"symmetric"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Give your key an ",(0,i.kt)("strong",{parentName:"p"},"alias"),", like\n",(0,i.kt)("em",{parentName:"p"},"SalesforceCredentialsSecretsManagerKey"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Next")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select administrators you want to have access permission to change\nthe key policy. Make sure you are being as restrictive as possible")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Next")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the users and roles you want to have access to the Salesforce\ncredentials in Secrets Manager. Make sure you are being as\nrestrictive as possible")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Next")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Finish")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate back to the Secrets Manager setup tab")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the key you just created"))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image130.png")}),(0,i.kt)("ol",{start:21},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Next")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Give your secret a name, like ",(0,i.kt)("em",{parentName:"p"},"SalesforceCredentials"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Next")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Make sure ",(0,i.kt)("strong",{parentName:"p"},"automatic rotation")," is disabled.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Next")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click Store")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the secret you just created, and copy the Secret ARN"))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image131.png")}),(0,i.kt)("ol",{start:28},(0,i.kt)("li",{parentName:"ol"},"You should now have all of the information you need to install the\npackage")),(0,i.kt)("h2",{id:"install-the-amazon-connect-salesforce-lambda-package"},"Install the Amazon Connect Salesforce Lambda package"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Login into your AWS Account")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate AWS Serverless Application Repository\n(",(0,i.kt)("a",{parentName:"p",href:"https://aws.amazon.com/serverless/serverlessrepo/"},"https://aws.amazon.com/serverless/serverlessrepo/"),")"))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image132.png")}),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},"Click on the Search (magnifying glass) and type in Amazon Connect\nSalesforce.")),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image133.png")}),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},'Select AmazonConnectSalesForceLambdas and click "Deploy"')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image134.png")}),(0,i.kt)("ol",{start:5},(0,i.kt)("li",{parentName:"ol"},'Fill in all Salesforce related fields in "Configure application\nparameters".\\\nAll values should be available in your installation notes:')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image135.png")}),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image136.png")}),(0,i.kt)("ol",{start:6},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"The Lambda package includes additional features which can be enabled\nor disabled, based on particular use-case:"),(0,i.kt)("p",{parentName:"li"},"a.  ",(0,i.kt)("em",{parentName:"p"},"PostcallCTRImportEnabled")," -- if set to true, the package will\ninclude a feature to import Amazon Connect CTRs into your\nSalesforce Org. Once enabled, you can decide which CTR records\nshould be imported, by setting a custom attribute\n(",(0,i.kt)("em",{parentName:"p"},"postcallCTRImportEnabled"),") in your Contact Flow. This feature\nrequires you to provide ",(0,i.kt)("em",{parentName:"p"},"CTRKinesisARN"),"."),(0,i.kt)("p",{parentName:"li"},"b.  ",(0,i.kt)("em",{parentName:"p"},"PostcallRecordingImportEnabled")," -- if set to true, the package\nwill include a feature to import Amazon Connect Call Recording\n(wav) files into your Salesforce Org. This feature is not\nrequired if you only need a call recording link in your\nSalesforce Org. Once enabled, you can decide which Call\nRecordings should be imported, by setting a custom attribute\n(",(0,i.kt)("em",{parentName:"p"},"postcallRecordingImportEnabled"),") in your Contact Flow. This\nfeature requires you to provide: ",(0,i.kt)("em",{parentName:"p"},"CTRKinesisARN,\nConnectRecordingS3BucketName")," and ",(0,i.kt)("em",{parentName:"p"},"TranscribeOutputS3BucketName")),(0,i.kt)("p",{parentName:"li"},"c.  ",(0,i.kt)("em",{parentName:"p"},"PostcallTranscribeEnabled")," -- if set to true, the package will\ninclude a feature to transcribe Amazon Connect Call Recordings,\nusing Amazon Transcribe, and provide Speech Analytics, using\nAmazon Comprehend, then import results into your Salesforce Org.\nOnce enabled, you can decide which Call Recordings should be\ntranscribed and analyzed, by setting custom attributes\n(",(0,i.kt)("em",{parentName:"p"},"postcallTranscribeEnabled"),", ",(0,i.kt)("em",{parentName:"p"},"postcallTranscribeLanguage")," and\n",(0,i.kt)("em",{parentName:"p"},"postcallTranscribeComprehendAnalysis"),") in your Contact Flow.\nThis feature requires you to provide: ",(0,i.kt)("em",{parentName:"p"},"CTRKinesisARN,\nConnectRecordingS3BucketName")," and ",(0,i.kt)("em",{parentName:"p"},"TranscribeOutputS3BucketName")),(0,i.kt)("p",{parentName:"li"},"d.  ",(0,i.kt)("em",{parentName:"p"},"RealtimeReportImportEnabled")," -- if set to true, the package\nwill include a feature to publish Amazon Connect Queue Metrics\ninto your Salesforce Org. This feature requires you to provide\n",(0,i.kt)("em",{parentName:"p"},"AmazonConnectInstanceId")),(0,i.kt)("p",{parentName:"li"},"e.  ",(0,i.kt)("em",{parentName:"p"},"HistoricalReportingImportEnabled")," -- if set to true, the\npackage will include a feature to import Amazon Connect Queue\nand Agent Historical Metrics into your Salesforce Org. This\nfeature requires you to provide ",(0,i.kt)("em",{parentName:"p"},"ConnectReportingS3BucketName")),(0,i.kt)("p",{parentName:"li"},"f.  ",(0,i.kt)("em",{parentName:"p"},"CTRKinesisARN")," -- please set Amazon Kinesis Stream ARN that is\nattached to you Amazon Connect instance as Contact Trace Records\ndestination. Amazon Kinesis Firehose is not supported. This\nparameter is mandatory for certain features, please see above."),(0,i.kt)("p",{parentName:"li"},"g.  ",(0,i.kt)("em",{parentName:"p"},"ConnectRecordingS3BucketName")," -- this is the S3 bucket where\nAmazon Connect stores call recordings. This parameter is\nmandatory for certain features, please see above."),(0,i.kt)("p",{parentName:"li"},"h.  ",(0,i.kt)("em",{parentName:"p"},"ConnectReportingS3BucketName")," -- this is the S3 bucket name\nwhere Amazon Connect stores schedule reports. This parameter is\nmandatory for Historical Reporting Import."),(0,i.kt)("p",{parentName:"li"},"i.  ",(0,i.kt)("em",{parentName:"p"},"AmazonConnectInstanceId")," -- this parameter is mandatory for\nRealtime Reporting Import"),(0,i.kt)("p",{parentName:"li"},"j.  ",(0,i.kt)("em",{parentName:"p"},"TranscribeOutputS3BucketName")," -- this is the S3 bucket where\nAmazon Transcribe stores the output. You can use an existing\nbucket, or create a new one, as the installation process doesn't\ncreate one for you. This parameter in mandatory certain\nfeatures, please see above."),(0,i.kt)("p",{parentName:"li"},"k.  ",(0,i.kt)("em",{parentName:"p"},"SalesforceHost:")," The full domain for your salesforce org. For\nexample\n",(0,i.kt)("inlineCode",{parentName:"p"},"https://mydevorg-dev-ed.my.salesforce.com"),".\nPlease make sure that the host starts with ",(0,i.kt)("inlineCode",{parentName:"p"},"https"),", and that the url\nends with ",(0,i.kt)("inlineCode",{parentName:"p"},".my.salesforce.com"),". This url can be found in ",(0,i.kt)("inlineCode",{parentName:"p"},"Setup")," -> ",(0,i.kt)("inlineCode",{parentName:"p"},"My Domain"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Once completed, click "Deploy" function:'))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image137.png")}),(0,i.kt)("ol",{start:8},(0,i.kt)("li",{parentName:"ol"},"The package provides a single Lambda function (sfInvokeAPI) that\nsupports multiple operations, like lookup, create and update. For\nthe initial validation, sample events are provided within the\nfunction. Click on the function name and check the list of files in\nthe editor.")),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image138.png")}),(0,i.kt)("ol",{start:9},(0,i.kt)("li",{parentName:"ol"},"To validate a phone number lookup, double-click on\nevent-phoneLookup.json file and copy the text in your clipboard.")),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image139.png")}),(0,i.kt)("ol",{start:10},(0,i.kt)("li",{parentName:"ol"},'In the top-right corner, click the drop-down arrow next to the\n"Test" button and select "Configure test events"')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image140.png")}),(0,i.kt)("ol",{start:11},(0,i.kt)("li",{parentName:"ol"},'Select "Create new test event", set Event name (i.e. phoneLookup)\nand paste the JSON payload you\'ve copied in the previous step.')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image141.png")}),(0,i.kt)("ol",{start:12},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Click "Create" button')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'From the drop-down list, select your "eventLookup" and click "Test"\nbutton'))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image142.png")}),(0,i.kt)("ol",{start:14},(0,i.kt)("li",{parentName:"ol"},'If successful, the result will contain fields defined in "sf_fields"\nparameter in the invocation event')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image143.png")}),(0,i.kt)("ol",{start:15},(0,i.kt)("li",{parentName:"ol"},'As a next step, we are going to use the ContactId provided and\ncreate a Case in Salesforce. Double-click on "event-create.json"\nfile and set the ContactId value from the previous step. Copy the\nJSON text into your clipboard.')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image144.png")}),(0,i.kt)("ol",{start:16},(0,i.kt)("li",{parentName:"ol"},'In the top-right corner, click the drop-down arrow next to the\n"Test" button and select "Configure test events"')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image145.png")}),(0,i.kt)("ol",{start:17},(0,i.kt)("li",{parentName:"ol"},'Select "Create new test event", set Event name (i.e. createCase) and\npaste the JSON payload you\'ve copied in the previous step.')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image146.png")}),(0,i.kt)("ol",{start:18},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Click "Create" button')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'From the drop-down list, select your "createCase" and click "Test"\nbutton'))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image147.png")}),(0,i.kt)("ol",{start:20},(0,i.kt)("li",{parentName:"ol"},"If successful, the result will contain a Case Id for newly created\ncase:")),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image148.png")}),(0,i.kt)("ol",{start:21},(0,i.kt)("li",{parentName:"ol"},'As defined in the event payload, Status is "New" and Priority is\n"Low". We are going to use the update operation to close the case.\nCopy the Case Id provided in the previous step, then double-click on\n"event-update.json" file and paste the Case Id in "sf_id" parameter:')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image149.png")}),(0,i.kt)("ol",{start:22},(0,i.kt)("li",{parentName:"ol"},'In the top-right corner, click the drop-down arrow next to the\n"Test" button and select "Configure test events"')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image150.png")}),(0,i.kt)("ol",{start:23},(0,i.kt)("li",{parentName:"ol"},'Select "Create new test event", set Event name (i.e. closeCase) and\npaste the JSON payload you\'ve copied in the previous step.')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image151.png")}),(0,i.kt)("ol",{start:24},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Click "Create" button')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'From the drop-down list, select your "closeCase" and click "Test"\nbutton'))),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image152.png")}),(0,i.kt)("ol",{start:26},(0,i.kt)("li",{parentName:"ol"},'If successful, the result will be HTTP code 204 ("No Content"\nsuccess code):')),(0,i.kt)("img",{src:(0,o.Z)("/img/classic/image153.png")}),(0,i.kt)("ol",{start:27},(0,i.kt)("li",{parentName:"ol"},'Login in to Salesforce and search for Case and it\'s details. The\nCase status should be "Closed".')))}u.isMDXComponent=!0}}]);